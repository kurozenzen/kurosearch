import{a as u}from"./tags.49324235.js";import{d,e as m,S as f}from"./store-keys.5df44647.js";import{w as i}from"./index.31dec069.js";const b=(s,a,n=d,e=m)=>{let r;r=localStorage.getItem("kurosearch:localstorage-enabled")==="true"?localStorage:sessionStorage;const o=r?r.getItem(s):null,t=y(a,o,e),c=i(t);return c.subscribe(l=>{sessionStorage.setItem(s,n(l)),localStorage.setItem(s,n(l))}),c},y=(s,a,n)=>{if(a===null)return s;try{const e=n(a);return e===void 0?s:!Array.isArray(e)&&typeof e=="object"&&typeof s=="object"?{...s,...e}:e}catch{return s}},g=()=>{const{subscribe:s,update:a,set:n}=b(f.ActiveTags,[]);return{subscribe:s,set:n,addOrReplace:e=>a(r=>{const o=r.findIndex(t=>t.name===e.name);return o===-1?r.push(e):r[o]=e,r}),addByName:async(e,r="+")=>{let o={modifier:r,name:e,count:0,type:"general"};try{const t=await u(e);o.count=(t==null?void 0:t.count)??0,o.type=(t==null?void 0:t.type)??"tag"}catch{}a(t=>(t.some(c=>c.name===e)||t.push(o),t))},removeByName:e=>a(r=>{const o=r.findIndex(t=>t.name===e);return r.splice(o,1),r}),reset:()=>n([])}},h=g();export{h as a,b as s};
