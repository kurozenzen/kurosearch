import{s as te,f as E,a as T,l as G,g as y,h as w,d,c as C,m as H,j as m,N as M,i as L,u as k,F as N,n as z,v as q,D as se,p as ue,E as Q,L as he,H as me,r as ge,e as R,G as pe}from"./scheduler.32f194ce.js";import{h as W,u as de}from"./await_block.af8be678.js";import{e as X}from"./each.e59479a4.js";import{S as le,i as oe,f as _e,b as K,d as O,m as U,a as I,t as D,e as j,g as ne,c as ae}from"./index.aa0a4971.js";import{b as be}from"./paths.84ae70a9.js";import{M as ke}from"./ModifierSelect.b17e978c.js";import{L as ve}from"./LoadingAnimation.1752780f.js";import{C as Se}from"./CodiconLink.9994dbe4.js";import{a as Y,f as Z}from"./format-tag.7e313273.js";import{a as Ee}from"./tags.4787ef96.js";function ye(n){let e,o,r,s,l,t=Y(n[0].label)+"",a,i,c,v=Z(n[0].count)+"",_,S,b,P;return{c(){e=E("li"),o=E("i"),s=T(),l=E("span"),a=G(t),i=T(),c=E("span"),_=G(v),this.h()},l(p){e=y(p,"LI",{role:!0,tabindex:!0,title:!0,class:!0});var f=w(e);o=y(f,"I",{class:!0}),w(o).forEach(d),s=C(f),l=y(f,"SPAN",{class:!0});var g=w(l);a=H(g,t),g.forEach(d),i=C(f),c=y(f,"SPAN",{class:!0});var u=w(c);_=H(u,v),u.forEach(d),f.forEach(d),this.h()},h(){m(o,"class",r=n[0].type==="supertag"?"codicon codicon-star-full":"codicon codicon-tag"),m(l,"class","tag-name svelte-1d1xyf4"),m(c,"class","tag-count"),m(e,"role","button"),m(e,"tabindex","0"),m(e,"title",S=n[0].label),m(e,"class","svelte-1d1xyf4"),M(e,"selected",n[1])},m(p,f){L(p,e,f),k(e,o),k(e,s),k(e,l),k(l,a),k(e,i),k(e,c),k(c,_),b||(P=N(e,"click",n[3]),b=!0)},p(p,[f]){f&1&&r!==(r=p[0].type==="supertag"?"codicon codicon-star-full":"codicon codicon-tag")&&m(o,"class",r),f&1&&t!==(t=Y(p[0].label)+"")&&z(a,t),f&1&&v!==(v=Z(p[0].count)+"")&&z(_,v),f&1&&S!==(S=p[0].label)&&m(e,"title",S),f&2&&M(e,"selected",p[1])},i:q,o:q,d(p){p&&d(e),b=!1,P()}}}function we(n,e,o){const r=se();let{suggestion:s}=e,{selected:l=!1}=e;const t=()=>r("click",s);return n.$$set=a=>{"suggestion"in a&&o(0,s=a.suggestion),"selected"in a&&o(1,l=a.selected)},[s,l,r,t]}class Ie extends le{constructor(e){super(),oe(this,e,we,ye,te,{suggestion:0,selected:1})}}function $(n,e,o){const r=n.slice();return r[21]=e[o],r[23]=o,r}function Ae(n){let e,o,r,s,l=n[24].message+"",t;return{c(){e=E("div"),o=E("i"),r=T(),s=E("span"),t=G(l),this.h()},l(a){e=y(a,"DIV",{class:!0});var i=w(e);o=y(i,"I",{class:!0}),w(o).forEach(d),r=C(i),s=y(i,"SPAN",{});var c=w(s);t=H(c,l),c.forEach(d),i.forEach(d),this.h()},h(){m(o,"class",ge("codicon codicon-error")+" svelte-1fnp487"),m(e,"class","suggestion-footer svelte-1fnp487")},m(a,i){L(a,e,i),k(e,o),k(e,r),k(e,s),k(s,t)},p(a,i){i&4&&l!==(l=a[24].message+"")&&z(t,l)},i:q,o:q,d(a){a&&d(e)}}}function De(n){let e=Array.isArray(n[20]),o,r,s,l=e&&x(n);return{c(){l&&l.c(),o=T(),r=E("div"),this.h()},l(t){l&&l.l(t),o=C(t),r=y(t,"DIV",{class:!0}),w(r).forEach(d),this.h()},h(){m(r,"class","suggestion-footer svelte-1fnp487")},m(t,a){l&&l.m(t,a),L(t,o,a),L(t,r,a),s=!0},p(t,a){a&4&&(e=Array.isArray(t[20])),e?l?(l.p(t,a),a&4&&I(l,1)):(l=x(t),l.c(),I(l,1),l.m(o.parentNode,o)):l&&(ne(),D(l,1,1,()=>{l=null}),ae())},i(t){s||(I(l),s=!0)},o(t){D(l),s=!1},d(t){t&&(d(o),d(r)),l&&l.d(t)}}}function x(n){let e,o,r=X(n[20]),s=[];for(let t=0;t<r.length;t+=1)s[t]=ee($(n,r,t));const l=t=>D(s[t],1,1,()=>{s[t]=null});return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=R()},l(t){for(let a=0;a<s.length;a+=1)s[a].l(t);e=R()},m(t,a){for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(t,a);L(t,e,a),o=!0},p(t,a){if(a&268){r=X(t[20]);let i;for(i=0;i<r.length;i+=1){const c=$(t,r,i);s[i]?(s[i].p(c,a),I(s[i],1)):(s[i]=ee(c),s[i].c(),I(s[i],1),s[i].m(e.parentNode,e))}for(ne(),i=r.length;i<s.length;i+=1)l(i);ae()}},i(t){if(!o){for(let a=0;a<r.length;a+=1)I(s[a]);o=!0}},o(t){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);o=!1},d(t){t&&d(e),pe(s,t)}}}function ee(n){let e,o;function r(){return n[16](n[21])}return e=new Ie({props:{suggestion:n[21],selected:n[23]===n[3]}}),e.$on("click",r),{c(){K(e.$$.fragment)},l(s){O(e.$$.fragment,s)},m(s,l){U(e,s,l),o=!0},p(s,l){n=s;const t={};l&4&&(t.suggestion=n[21]),l&8&&(t.selected=n[23]===n[3]),e.$set(t)},i(s){o||(I(e.$$.fragment,s),o=!0)},o(s){D(e.$$.fragment,s),o=!1},d(s){j(e,s)}}}function Ne(n){let e,o,r;return o=new ve({}),{c(){e=E("div"),K(o.$$.fragment),this.h()},l(s){e=y(s,"DIV",{class:!0});var l=w(e);O(o.$$.fragment,l),l.forEach(d),this.h()},h(){m(e,"class","suggestion-footer svelte-1fnp487")},m(s,l){L(s,e,l),U(o,e,null),r=!0},p:q,i(s){r||(I(o.$$.fragment,s),r=!0)},o(s){D(o.$$.fragment,s),r=!1},d(s){s&&d(e),j(o)}}}function Te(n){let e,o,r,s,l,t,a,i,c,v,_,S,b;function P(g){n[14](g)}let p={};n[4]!==void 0&&(p.modifier=n[4]),o=new ke({props:p}),ue.push(()=>_e(o,"modifier",P)),a=new Se({props:{title:"More information on tags.",href:be+"/help#tags",icon:"codicon codicon-question"}});let f={ctx:n,current:null,token:null,hasCatch:!0,pending:Ne,then:De,catch:Ae,value:20,error:24,blocks:[,,,]};return W(v=n[2],f),{c(){e=E("div"),K(o.$$.fragment),s=T(),l=E("input"),t=T(),K(a.$$.fragment),i=T(),c=E("ol"),f.block.c(),this.h()},l(g){e=y(g,"DIV",{class:!0});var u=w(e);O(o.$$.fragment,u),s=C(u),l=y(u,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0,autocomplete:!0,"aria-label":!0,class:!0}),t=C(u),O(a.$$.fragment,u),i=C(u),c=y(u,"OL",{class:!0});var A=w(c);f.block.l(A),A.forEach(d),u.forEach(d),this.h()},h(){m(l,"type","text"),m(l,"name","searchbar"),m(l,"id","searchbar"),m(l,"placeholder",n[0]),m(l,"autocomplete","off"),m(l,"aria-label","Search for tags."),m(l,"class","svelte-1fnp487"),m(c,"class","svelte-1fnp487"),M(c,"open",n[5]&&n[6]),m(e,"class","searchbar svelte-1fnp487"),M(e,"open",n[5]&&n[6])},m(g,u){L(g,e,u),U(o,e,null),k(e,s),k(e,l),Q(l,n[1]),k(e,t),U(a,e,null),k(e,i),k(e,c),f.block.m(c,f.anchor=null),f.mount=()=>c,f.anchor=null,_=!0,S||(b=[N(l,"input",n[15]),N(l,"focus",n[11]),N(l,"blur",n[10]),N(l,"keydown",n[12]),N(l,"keyup",n[7]),N(e,"blur",n[9])],S=!0)},p(g,[u]){n=g;const A={};!r&&u&16&&(r=!0,A.modifier=n[4],he(()=>r=!1)),o.$set(A),(!_||u&1)&&m(l,"placeholder",n[0]),u&2&&l.value!==n[1]&&Q(l,n[1]),f.ctx=n,u&4&&v!==(v=n[2])&&W(v,f)||de(f,n,u),(!_||u&96)&&M(c,"open",n[5]&&n[6]),(!_||u&96)&&M(e,"open",n[5]&&n[6])},i(g){_||(I(o.$$.fragment,g),I(a.$$.fragment,g),I(f.block),_=!0)},o(g){D(o.$$.fragment,g),D(a.$$.fragment,g);for(let u=0;u<3;u+=1){const A=f.blocks[u];D(A)}_=!1},d(g){g&&d(e),j(o),j(a),f.block.d(),f.token=null,f=null,S=!1,me(b)}}}function Ce(n,e,o){const r=se();let{placeholder:s}=e,{fetchSuggestions:l}=e,t="",a="",i,c=0,v="+",_=!1,S=!1,b=[];const P=()=>{t!==""&&t!==a&&(o(3,c=0),a=t,o(6,S=!0),o(2,i=l(t)),i.then(h=>b=h).catch(()=>b=[]))},p=h=>{r("pick",{modifier:v,...h}),o(1,t=""),o(3,c=0),o(6,S=!1)},f=()=>{o(5,_=!1)},g=h=>{(!h.relatedTarget||!h.target.parentNode.contains(h.relatedTarget))&&o(5,_=!1)},u=h=>{o(5,_=!0),h.target.scrollIntoView({block:"center",behavior:"smooth"})},A=async h=>{if(!h.ctrlKey&&h.key==="Enter"&&t!=="")if(b.length>c)p(b[c]);else{const J=t.split(";").map(F=>F.trim().replaceAll(" ","_")),fe=await Promise.all(J.map(Ee));J.map(F=>{const V=fe.find(B=>(B==null?void 0:B.name)===F);return{type:(V==null?void 0:V.type)??"tag",label:F,count:(V==null?void 0:V.count)??0}}).forEach(p)}else h.code==="Escape"?h.target.blur():h.code==="ArrowUp"&&b.length>0?o(3,c=(c+b.length-1)%b.length):h.code==="ArrowDown"&&b.length>0&&o(3,c=(c+1)%b.length)};function re(h){v=h,o(4,v)}function ie(){t=this.value,o(1,t)}const ce=h=>p(h);return n.$$set=h=>{"placeholder"in h&&o(0,s=h.placeholder),"fetchSuggestions"in h&&o(13,l=h.fetchSuggestions)},[s,t,i,c,v,_,S,P,p,f,g,u,A,l,re,ie,ce]}class Be extends le{constructor(e){super(),oe(this,e,Ce,Te,te,{placeholder:0,fetchSuggestions:13})}}export{Be as S};
