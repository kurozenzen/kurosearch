import{b as d}from"./user-id-store.83f6419e.js";import{d as m,e as f,S as i}from"./store-keys.402ed1b9.js";import{w as b}from"./index.d94cff24.js";const y=(s,o,n=m,e=f)=>{let r;r=localStorage.getItem("kurosearch:localstorage-enabled")==="true"?localStorage:sessionStorage;const a=r?r.getItem(s):null,c=g(o,a,e),l=b(c);return l.subscribe(t=>{sessionStorage.setItem(s,n(t)),localStorage.setItem(s,n(t))}),l},g=(s,o,n)=>{if(o===null)return s;try{const e=n(o);return e===void 0?s:!Array.isArray(e)&&typeof e=="object"&&typeof s=="object"?{...s,...e}:e}catch{return s}},S=()=>{const{subscribe:s,update:o,set:n}=y(i.ActiveTags,[]);return{subscribe:s,set:n,addOrReplace:e=>o(r=>{const a=r.findIndex(c=>c.name===e.name);return a===-1?r.push(e):r[a]=e,r}),addByName:async(e,r="+",a="",c="")=>{let l={modifier:r,name:e,count:0,type:"general"};try{const t=await d(e,a,c);l.count=(t==null?void 0:t.count)??0,l.type=(t==null?void 0:t.type)??"tag"}catch{}o(t=>(t.some(u=>u.name===e)||t.push(l),t))},removeByName:e=>o(r=>{const a=r.findIndex(c=>c.name===e);return r.splice(a,1),r}),reset:()=>n([])}},T=S();export{T as a,y as s};
