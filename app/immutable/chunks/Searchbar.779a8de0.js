import{s as se,f as y,a as C,l as G,g as S,h as E,d,c as P,m as J,j as g,B as M,i as K,u as b,J as T,n as z,v as O,M as le,p as pe,I as Q,K as ge,O as _e,y as R,r as de,e as W,G as be}from"./scheduler.41e0bfa2.js";import{h as X,u as ke}from"./await_block.421e30a4.js";import{e as Y}from"./each.e59479a4.js";import{S as oe,i as ne,f as ve,b as q,d as B,m as U,a as w,t as D,e as j,g as ae,c as re}from"./index.e3f19884.js";import{b as ye}from"./paths.b1d8f074.js";import{M as Se}from"./ModifierSelect.0aadd9b4.js";import{L as Ie}from"./LoadingAnimation.99c029b8.js";import{C as Ee}from"./CodiconLink.e69c86af.js";import{a as Z,f as $}from"./format-tag.7e313273.js";import{u as we,a as Ae,b as De}from"./user-id-store.83f6419e.js";function Ne(o){let e,s,i,t,l,n=Z(o[0].label)+"",a,r,h,k=$(o[0].count)+"",_,v,I,N;return{c(){e=y("li"),s=y("i"),t=C(),l=y("span"),a=G(n),r=C(),h=y("span"),_=G(k),this.h()},l(m){e=S(m,"LI",{role:!0,tabindex:!0,title:!0,class:!0});var c=E(e);s=S(c,"I",{class:!0}),E(s).forEach(d),t=P(c),l=S(c,"SPAN",{class:!0});var p=E(l);a=J(p,n),p.forEach(d),r=P(c),h=S(c,"SPAN",{class:!0});var u=E(h);_=J(u,k),u.forEach(d),c.forEach(d),this.h()},h(){g(s,"class",i=o[0].type==="supertag"?"codicon codicon-star-full":"codicon codicon-tag"),g(l,"class","tag-name svelte-1d1xyf4"),g(h,"class","tag-count"),g(e,"role","button"),g(e,"tabindex","0"),g(e,"title",v=o[0].label),g(e,"class","svelte-1d1xyf4"),M(e,"selected",o[1])},m(m,c){K(m,e,c),b(e,s),b(e,t),b(e,l),b(l,a),b(e,r),b(e,h),b(h,_),I||(N=T(e,"click",o[3]),I=!0)},p(m,[c]){c&1&&i!==(i=m[0].type==="supertag"?"codicon codicon-star-full":"codicon codicon-tag")&&g(s,"class",i),c&1&&n!==(n=Z(m[0].label)+"")&&z(a,n),c&1&&k!==(k=$(m[0].count)+"")&&z(_,k),c&1&&v!==(v=m[0].label)&&g(e,"title",v),c&2&&M(e,"selected",m[1])},i:O,o:O,d(m){m&&d(e),I=!1,N()}}}function Te(o,e,s){const i=le();let{suggestion:t}=e,{selected:l=!1}=e;const n=()=>i("click",t);return o.$$set=a=>{"suggestion"in a&&s(0,t=a.suggestion),"selected"in a&&s(1,l=a.selected)},[t,l,i,n]}class Ce extends oe{constructor(e){super(),ne(this,e,Te,Ne,se,{suggestion:0,selected:1})}}function x(o,e,s){const i=o.slice();return i[23]=e[s],i[25]=s,i}function Pe(o){let e,s,i,t,l=o[26].message+"",n;return{c(){e=y("div"),s=y("i"),i=C(),t=y("span"),n=G(l),this.h()},l(a){e=S(a,"DIV",{class:!0});var r=E(e);s=S(r,"I",{class:!0}),E(s).forEach(d),i=P(r),t=S(r,"SPAN",{});var h=E(t);n=J(h,l),h.forEach(d),r.forEach(d),this.h()},h(){g(s,"class",de("codicon codicon-error")+" svelte-1fnp487"),g(e,"class","suggestion-footer svelte-1fnp487")},m(a,r){K(a,e,r),b(e,s),b(e,i),b(e,t),b(t,n)},p(a,r){r&4&&l!==(l=a[26].message+"")&&z(n,l)},i:O,o:O,d(a){a&&d(e)}}}function Ke(o){let e=Array.isArray(o[22]),s,i,t,l=e&&ee(o);return{c(){l&&l.c(),s=C(),i=y("div"),this.h()},l(n){l&&l.l(n),s=P(n),i=S(n,"DIV",{class:!0}),E(i).forEach(d),this.h()},h(){g(i,"class","suggestion-footer svelte-1fnp487")},m(n,a){l&&l.m(n,a),K(n,s,a),K(n,i,a),t=!0},p(n,a){a&4&&(e=Array.isArray(n[22])),e?l?(l.p(n,a),a&4&&w(l,1)):(l=ee(n),l.c(),w(l,1),l.m(s.parentNode,s)):l&&(ae(),D(l,1,1,()=>{l=null}),re())},i(n){t||(w(l),t=!0)},o(n){D(l),t=!1},d(n){n&&(d(s),d(i)),l&&l.d(n)}}}function ee(o){let e,s,i=Y(o[22]),t=[];for(let n=0;n<i.length;n+=1)t[n]=te(x(o,i,n));const l=n=>D(t[n],1,1,()=>{t[n]=null});return{c(){for(let n=0;n<t.length;n+=1)t[n].c();e=W()},l(n){for(let a=0;a<t.length;a+=1)t[a].l(n);e=W()},m(n,a){for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(n,a);K(n,e,a),s=!0},p(n,a){if(a&268){i=Y(n[22]);let r;for(r=0;r<i.length;r+=1){const h=x(n,i,r);t[r]?(t[r].p(h,a),w(t[r],1)):(t[r]=te(h),t[r].c(),w(t[r],1),t[r].m(e.parentNode,e))}for(ae(),r=i.length;r<t.length;r+=1)l(r);re()}},i(n){if(!s){for(let a=0;a<i.length;a+=1)w(t[a]);s=!0}},o(n){t=t.filter(Boolean);for(let a=0;a<t.length;a+=1)D(t[a]);s=!1},d(n){n&&d(e),be(t,n)}}}function te(o){let e,s;function i(){return o[16](o[23])}return e=new Ce({props:{suggestion:o[23],selected:o[25]===o[3]}}),e.$on("click",i),{c(){q(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,l){U(e,t,l),s=!0},p(t,l){o=t;const n={};l&4&&(n.suggestion=o[23]),l&8&&(n.selected=o[25]===o[3]),e.$set(n)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){D(e.$$.fragment,t),s=!1},d(t){j(e,t)}}}function Le(o){let e,s,i;return s=new Ie({}),{c(){e=y("div"),q(s.$$.fragment),this.h()},l(t){e=S(t,"DIV",{class:!0});var l=E(e);B(s.$$.fragment,l),l.forEach(d),this.h()},h(){g(e,"class","suggestion-footer svelte-1fnp487")},m(t,l){K(t,e,l),U(s,e,null),i=!0},p:O,i(t){i||(w(s.$$.fragment,t),i=!0)},o(t){D(s.$$.fragment,t),i=!1},d(t){t&&d(e),j(s)}}}function Ve(o){let e,s,i,t,l,n,a,r,h,k,_,v,I;function N(p){o[14](p)}let m={};o[4]!==void 0&&(m.modifier=o[4]),s=new Se({props:m}),pe.push(()=>ve(s,"modifier",N)),a=new Ee({props:{title:"More information on tags.",href:ye+"/help#search",icon:"codicon codicon-question"}});let c={ctx:o,current:null,token:null,hasCatch:!0,pending:Le,then:Ke,catch:Pe,value:22,error:26,blocks:[,,,]};return X(k=o[2],c),{c(){e=y("div"),q(s.$$.fragment),t=C(),l=y("input"),n=C(),q(a.$$.fragment),r=C(),h=y("ol"),c.block.c(),this.h()},l(p){e=S(p,"DIV",{class:!0});var u=E(e);B(s.$$.fragment,u),t=P(u),l=S(u,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0,autocomplete:!0,"aria-label":!0,class:!0}),n=P(u),B(a.$$.fragment,u),r=P(u),h=S(u,"OL",{class:!0});var A=E(h);c.block.l(A),A.forEach(d),u.forEach(d),this.h()},h(){g(l,"type","text"),g(l,"name","searchbar"),g(l,"id","searchbar"),g(l,"placeholder",o[0]),g(l,"autocomplete","off"),g(l,"aria-label","Search for tags."),g(l,"class","svelte-1fnp487"),g(h,"class","svelte-1fnp487"),M(h,"open",o[5]&&o[6]),g(e,"class","searchbar svelte-1fnp487"),M(e,"open",o[5]&&o[6])},m(p,u){K(p,e,u),U(s,e,null),b(e,t),b(e,l),Q(l,o[1]),b(e,n),U(a,e,null),b(e,r),b(e,h),c.block.m(h,c.anchor=null),c.mount=()=>h,c.anchor=null,_=!0,v||(I=[T(l,"input",o[15]),T(l,"focus",o[11]),T(l,"blur",o[10]),T(l,"keydown",o[12]),T(l,"keyup",o[7]),T(e,"blur",o[9])],v=!0)},p(p,[u]){o=p;const A={};!i&&u&16&&(i=!0,A.modifier=o[4],ge(()=>i=!1)),s.$set(A),(!_||u&1)&&g(l,"placeholder",o[0]),u&2&&l.value!==o[1]&&Q(l,o[1]),c.ctx=o,u&4&&k!==(k=o[2])&&X(k,c)||ke(c,o,u),(!_||u&96)&&M(h,"open",o[5]&&o[6]),(!_||u&96)&&M(e,"open",o[5]&&o[6])},i(p){_||(w(s.$$.fragment,p),w(a.$$.fragment,p),w(c.block),_=!0)},o(p){D(s.$$.fragment,p),D(a.$$.fragment,p);for(let u=0;u<3;u+=1){const A=c.blocks[u];D(A)}_=!1},d(p){p&&d(e),j(s),j(a),c.block.d(),c.token=null,c=null,v=!1,_e(I)}}}function Me(o,e,s){let i,t;R(o,we,f=>s(19,i=f)),R(o,Ae,f=>s(20,t=f));const l=le();let{placeholder:n}=e,{fetchSuggestions:a}=e,r="",h="",k,_=0,v="+",I=!1,N=!1,m=[];const c=()=>{r!==""&&r!==h&&(s(3,_=0),h=r,s(6,N=!0),s(2,k=a(r)),k.then(f=>m=f).catch(()=>m=[]))},p=f=>{l("pick",{modifier:v,...f}),s(1,r=""),s(3,_=0),s(6,N=!1)},u=()=>{s(5,I=!1)},A=f=>{(!f.relatedTarget||!f.target.parentNode.contains(f.relatedTarget))&&s(5,I=!1)},ie=f=>{s(5,I=!0),f.target.scrollIntoView({block:"center",behavior:"smooth"})},ce=async f=>{if(!f.ctrlKey&&f.key==="Enter"&&r!=="")if(m.length>_)p(m[_]);else{const H=r.split(";").map(L=>L.trim().replaceAll(" ","_")),me=await Promise.all(H.map(L=>De(L,t,i)));H.map(L=>{const V=me.find(F=>(F==null?void 0:F.name)===L);return{type:(V==null?void 0:V.type)??"tag",label:L,count:(V==null?void 0:V.count)??0}}).forEach(p)}else f.code==="Escape"?f.target.blur():f.code==="ArrowUp"&&m.length>0?s(3,_=(_+m.length-1)%m.length):f.code==="ArrowDown"&&m.length>0&&s(3,_=(_+1)%m.length)};function fe(f){v=f,s(4,v)}function ue(){r=this.value,s(1,r)}const he=f=>p(f);return o.$$set=f=>{"placeholder"in f&&s(0,n=f.placeholder),"fetchSuggestions"in f&&s(13,a=f.fetchSuggestions)},[n,r,k,_,v,I,N,c,p,u,A,ie,ce,a,fe,ue,he]}class Qe extends oe{constructor(e){super(),ne(this,e,Me,Ve,se,{placeholder:0,fetchSuggestions:13})}}export{Qe as S};
