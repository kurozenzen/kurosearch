import{s as oe,f as A,a as K,W as ne,l as I,w as le,g as D,d as S,c as R,h as j,X as ie,m as L,j as z,u as i,i as ee,n as M,G as ce,y as q}from"../chunks/scheduler.41e0bfa2.js";import{S as me,i as ue,b as X,d as $,m as F,a as J,t as Y,e as Z}from"../chunks/index.e3f19884.js";import{e as ae}from"../chunks/each.e59479a4.js";import{K as pe,A as ge}from"../chunks/ActiveTagList.5f4504d1.js";import{S as he}from"../chunks/Searchbar.779a8de0.js";import{g as de,b as fe,u as _e,a as we}from"../chunks/user-id-store.83f6419e.js";import{a as x,r as ye}from"../chunks/blocking-group-data.30d9061c.js";import{a as G}from"../chunks/active-tags-store.896aa6fe.js";import{S as Se,f as ve,s as be}from"../chunks/url-parsing.e89d4ab7.js";import{b as ke}from"../chunks/blocked-content-store.101e0b86.js";import{n as Ce,s as Te}from"../chunks/supertags-store.71274ea7.js";function se(t,n,r){const s=t.slice();return s[18]=n[r],s}function re(t){let n,r=t[18][0]+"",s,d,_=t[18][1]+"",m;return{c(){n=A("p"),s=I(r),d=I("="),m=I(_),this.h()},l(u){n=D(u,"P",{class:!0});var o=j(n);s=L(o,r),d=L(o,"="),m=L(o,_),o.forEach(S),this.h()},h(){z(n,"class","fixed svelte-15wziqd")},m(u,o){ee(u,n,o),i(n,s),i(n,d),i(n,m)},p(u,o){o&64&&r!==(r=u[18][0]+"")&&M(s,r),o&64&&_!==(_=u[18][1]+"")&&M(m,_)},d(u){u&&S(n)}}}function Ee(t){let n,r,s,d,_,m,u,o,P,v,C,O,p,y,T,H,U,b,B=t[5][0]+"",N,e,k=t[5][1]+"",w,g;d=new pe({}),m=new he({props:{placeholder:"Search for tags",fetchSuggestions:t[9]}}),m.$on("pick",t[14]),o=new ge({props:{tags:[...t[2],...t[1]]}}),o.$on("click",t[15]),o.$on("contextmenu",t[16]);let Q=ae(t[6]),c=[];for(let a=0;a<Q.length;a+=1)c[a]=re(se(t,Q,a));return{c(){n=A("meta"),r=K(),s=A("section"),X(d.$$.fragment),_=K(),X(m.$$.fragment),u=K(),X(o.$$.fragment),P=K(),v=A("code"),C=new ne(!1),O=K(),p=A("code"),y=A("p"),T=I(t[7]),H=K();for(let a=0;a<c.length;a+=1)c[a].c();U=K(),b=A("p"),N=I(B),e=I("="),w=I(k),this.h()},l(a){const f=le("svelte-2w1wl5",document.head);n=D(f,"META",{name:!0,content:!0}),f.forEach(S),r=R(a),s=D(a,"SECTION",{class:!0});var l=j(s);$(d.$$.fragment,l),_=R(l),$(m.$$.fragment,l),u=R(l),$(o.$$.fragment,l),P=R(l),v=D(l,"CODE",{class:!0});var h=j(v);C=ie(h,!1),h.forEach(S),O=R(l),p=D(l,"CODE",{class:!0});var E=j(p);y=D(E,"P",{class:!0});var te=j(y);T=L(te,t[7]),te.forEach(S),H=R(E);for(let W=0;W<c.length;W+=1)c[W].l(E);U=R(E),b=D(E,"P",{class:!0});var V=j(b);N=L(V,B),e=L(V,"="),w=L(V,k),V.forEach(S),E.forEach(S),l.forEach(S),this.h()},h(){document.title="kurosearch - Query Builder",z(n,"name","description"),z(n,"content","Test your kurosearch queries. Useful if you already know how to use rule34.xxx"),C.a=null,z(v,"class","svelte-15wziqd"),z(y,"class","base svelte-15wziqd"),z(b,"class","tags svelte-15wziqd"),z(p,"class","svelte-15wziqd"),z(s,"class","svelte-15wziqd")},m(a,f){i(document.head,n),ee(a,r,f),ee(a,s,f),F(d,s,null),i(s,_),F(m,s,null),i(s,u),F(o,s,null),i(s,P),i(s,v),C.m(t[0],v),i(s,O),i(s,p),i(p,y),i(y,T),i(p,H);for(let l=0;l<c.length;l+=1)c[l]&&c[l].m(p,null);i(p,U),i(p,b),i(b,N),i(b,e),i(b,w),g=!0},p(a,[f]){const l={};if(f&6&&(l.tags=[...a[2],...a[1]]),o.$set(l),(!g||f&1)&&C.p(a[0]),(!g||f&128)&&M(T,a[7]),f&64){Q=ae(a[6]);let h;for(h=0;h<Q.length;h+=1){const E=se(a,Q,h);c[h]?c[h].p(E,f):(c[h]=re(E),c[h].c(),c[h].m(p,U))}for(;h<c.length;h+=1)c[h].d(1);c.length=Q.length}(!g||f&32)&&B!==(B=a[5][0]+"")&&M(N,B),(!g||f&32)&&k!==(k=a[5][1]+"")&&M(w,k)},i(a){g||(J(d.$$.fragment,a),J(m.$$.fragment,a),J(o.$$.fragment,a),g=!0)},o(a){Y(d.$$.fragment,a),Y(m.$$.fragment,a),Y(o.$$.fragment,a),g=!1},d(a){a&&(S(r),S(s)),S(n),Z(d),Z(m),Z(o),ce(c,a)}}}function qe(t,n,r){let s,d,_,m,u,o,P,v,C,O,p,y,T;q(t,x,e=>r(1,u=e)),q(t,ve,e=>r(10,o=e)),q(t,be,e=>r(11,P=e)),q(t,ke,e=>r(12,v=e)),q(t,G,e=>r(2,C=e)),q(t,ye,e=>r(13,O=e)),q(t,_e,e=>r(3,p=e)),q(t,we,e=>r(4,y=e)),q(t,Te,e=>r(8,T=e));const H=async e=>{const k=await de(e);return[...T.items.filter(({name:g})=>g.toLowerCase().includes(e.toLowerCase())).map(g=>({label:g.name,count:g.tags.length,type:"supertag"})),...k]},U=e=>{try{return new URL(e)}catch{return null}},b=async e=>{const k=e.detail;if(k.type==="supertag"){const w=T.items.find(g=>g.name===k.label);if(!w){console.warn("Supertag not present.");return}x.addOrReplace(w)}else{const w=await fe(e.detail.label,y,p);G.addOrReplace({name:e.detail.label,modifier:e.detail.modifier,count:e.detail.count,type:(w==null?void 0:w.type)??"tag"})}},B=e=>"description"in e.detail?x.removeByName(e.detail.name):G.removeByName(e.detail.name),N=e=>{"description"in e.detail||(e.detail.modifier=Ce(e.detail.modifier),G.addOrReplace(e.detail))};return t.$$.update=()=>{t.$$.dirty&15390&&r(0,s=U(new Se().withApiKey(y).withUserId(p).withPid(O.pageCount).withTags(C).withBlockedContent(v).withSortProperty(P.property).withSortDirection(P.direction).withScoreValue(o.scoreValue).withScoreComparator(o.scoreComparator).withRating(o.rating).withSupertags(u).getQuery())),t.$$.dirty&1&&r(7,d=s&&`${s.protocol}//${s.hostname}`),t.$$.dirty&1&&r(6,_=s?[...s.searchParams.entries()].filter(([e])=>["page","s","q","fields","json","limit"].includes(e)):[]),t.$$.dirty&1&&r(5,m=s?[...s.searchParams.entries()].find(([e])=>e==="tags")??["tags",""]:["tags",""])},[s,u,C,p,y,m,_,d,T,H,o,P,v,O,b,B,N]}class Ne extends me{constructor(n){super(),ue(this,n,qe,Ee,oe,{})}}export{Ne as component};
