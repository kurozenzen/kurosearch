import{s as ae,p as ke,E as Fe,F as Ve,f as E,a as N,g as S,h as A,y as ie,c as O,d as m,j as g,r as Mt,i as j,u as d,G as ze,H as me,I as Xe,J as it,l as re,m as oe,v as te,K as we,L as rn,o as lt,M as rt,w as on,A as an,B as cn,C as un,n as Te,k as Ge,z as Oe,D as fe,N as Vt,O as Ze,P as fn,Q as Bt,e as je,R as ft,x as pn}from"../chunks/scheduler.2e119837.js";import{S as ce,i as ue,f as Le,b as R,d as F,m as L,a as v,t as C,e as M,g as pe,c as _e,h as _n}from"../chunks/index.564f3e18.js";import{g as gn}from"../chunks/globals.7f7f1b26.js";import{e as Ee}from"../chunks/each.e59479a4.js";import{D as zt,a as Gt,r as Ut}from"../chunks/result-columns-store.30be9581.js";import{T as qe}from"../chunks/TextButton.1d7fb571.js";import{D as dn}from"../chunks/DetailedTag.23023067.js";import{K as mn,A as hn}from"../chunks/ActiveTagList.9bc071f1.js";import{b as Ht}from"../chunks/paths.4f043c04.js";import{f as Me}from"../chunks/format-tag.7e313273.js";import{r as Ye,a as at}from"../chunks/active-supertags-store.564ebb7d.js";import{I as $n,R as vn}from"../chunks/ModifierSelect.a17fc7e1.js";import{R as bn,S as qt,a as Kt,K as Wt,E as Jt,b as kn,C as Qt,P as Yt,g as wn,c as Zt,i as yn,d as Xt,G as Cn,V as En,e as pt,I as Sn}from"../chunks/Gif.7b87bc6d.js";import{p as In,S as Dn,b as Tn,a as Pn}from"../chunks/store-keys.5df44647.js";import{a as Nn}from"../chunks/always-loop-store.ba41ce48.js";import{f as Be,s as He,S as On}from"../chunks/search-builder.20b08516.js";import{S as jn}from"../chunks/Select.5cc822d6.js";import{R as An}from"../chunks/RotatingTextSelect.c6ebcec9.js";import{S as Rn}from"../chunks/Searchbar.68ef4154.js";import{S as Fn}from"../chunks/ScrollUpButton.e3e3b4de.js";import{g as Ln,a as Mn}from"../chunks/tags.49324235.js";import{l as Vn}from"../chunks/analytics.b280da65.js";import{n as Bn,s as _t}from"../chunks/supertags-store.2cd00a2c.js";import{a as ot}from"../chunks/active-tags-store.80efbdb8.js";import{b as zn}from"../chunks/blocked-content-store.a3596c49.js";import{L as xt}from"../chunks/LoadingAnimation.392b4d60.js";import{c as en}from"../chunks/cookies-accepted-store.833e5d68.js";function gt(l,e,n){const t=l.slice();return t[11]=e[n],t}function dt(l){let e,n;return e=new dn({props:{tag:l[11]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},p(t,s){const r={};s&8&&(r.tag=t[11]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Gn(l){let e;return{c(){e=re("Create supertag")},l(n){e=oe(n,"Create supertag")},m(n,t){j(n,e,t)},d(n){n&&m(e)}}}function Un(l){let e,n,t="Create Supertag",s,r,o,i,a,c="Name",u,p,f,k,_,b="Description",B,h,$,w,y,z="Tags",J,V,I,T,P,U,D,Z,Q=Ee(l[3]),H=[];for(let K=0;K<Q.length;K+=1)H[K]=dt(gt(l,Q,K));const x=K=>C(H[K],1,1,()=>{H[K]=null});return P=new qe({props:{title:l[4]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[4],$$slots:{default:[Gn]},$$scope:{ctx:l}}}),P.$on("click",l[9]),{c(){e=E("section"),n=E("h3"),n.textContent=t,s=N(),r=E("button"),o=N(),i=E("div"),a=E("label"),a.textContent=c,u=N(),p=E("input"),f=N(),k=E("div"),_=E("label"),_.textContent=b,B=N(),h=E("input"),$=N(),w=E("div"),y=E("span"),y.textContent=z,J=N(),V=E("ol");for(let K=0;K<H.length;K+=1)H[K].c();I=N(),T=E("div"),R(P.$$.fragment),this.h()},l(K){e=S(K,"SECTION",{class:!0});var W=A(e);n=S(W,"H3",{"data-svelte-h":!0}),ie(n)!=="svelte-ho1cwx"&&(n.textContent=t),s=O(W),r=S(W,"BUTTON",{class:!0}),A(r).forEach(m),o=O(W),i=S(W,"DIV",{class:!0});var ne=A(i);a=S(ne,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ie(a)!=="svelte-10k8a68"&&(a.textContent=c),u=O(ne),p=S(ne,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),ne.forEach(m),f=O(W),k=S(W,"DIV",{class:!0});var ee=A(k);_=S(ee,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ie(_)!=="svelte-14n9kp6"&&(_.textContent=b),B=O(ee),h=S(ee,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),ee.forEach(m),$=O(W),w=S(W,"DIV",{class:!0});var be=A(w);y=S(be,"SPAN",{class:!0,"data-svelte-h":!0}),ie(y)!=="svelte-7hjyox"&&(y.textContent=z),J=O(be),V=S(be,"OL",{class:!0});var ye=A(V);for(let Ce=0;Ce<H.length;Ce+=1)H[Ce].l(ye);ye.forEach(m),be.forEach(m),I=O(W),T=S(W,"DIV",{class:!0});var Ae=A(T);F(P.$$.fragment,Ae),Ae.forEach(m),W.forEach(m),this.h()},h(){g(r,"class",Mt("codicon codicon-close")+" svelte-1x6vc81"),g(a,"for","supertag-name"),g(a,"class","svelte-1x6vc81"),g(p,"type","text"),g(p,"placeholder","Descriptive name"),g(p,"id","supertag-name"),g(p,"class","svelte-1x6vc81"),g(i,"class","svelte-1x6vc81"),g(_,"for","supertag-description"),g(_,"class","svelte-1x6vc81"),g(h,"type","text"),g(h,"placeholder","Short description"),g(h,"id","supertag-description"),g(h,"class","svelte-1x6vc81"),g(k,"class","svelte-1x6vc81"),g(y,"class","svelte-1x6vc81"),g(V,"class","svelte-1x6vc81"),g(w,"class","svelte-1x6vc81"),g(T,"class","last svelte-1x6vc81"),g(e,"class","svelte-1x6vc81")},m(K,W){j(K,e,W),d(e,n),d(e,s),d(e,r),d(e,o),d(e,i),d(i,a),d(i,u),d(i,p),ze(p,l[0]),d(e,f),d(e,k),d(k,_),d(k,B),d(k,h),ze(h,l[2]),d(e,$),d(e,w),d(w,y),d(w,J),d(w,V);for(let ne=0;ne<H.length;ne+=1)H[ne]&&H[ne].m(V,null);d(e,I),d(e,T),L(P,T,null),U=!0,D||(Z=[me(r,"click",l[6]),me(p,"input",l[7]),me(h,"input",l[8])],D=!0)},p(K,W){if(W&1&&p.value!==K[0]&&ze(p,K[0]),W&4&&h.value!==K[2]&&ze(h,K[2]),W&8){Q=Ee(K[3]);let ee;for(ee=0;ee<Q.length;ee+=1){const be=gt(K,Q,ee);H[ee]?(H[ee].p(be,W),v(H[ee],1)):(H[ee]=dt(be),H[ee].c(),v(H[ee],1),H[ee].m(V,null))}for(pe(),ee=Q.length;ee<H.length;ee+=1)x(ee);_e()}const ne={};W&16&&(ne.title=K[4]?"Click to create supertag":"Enter a valid name to continue"),W&16&&(ne.disabled=!K[4]),W&16384&&(ne.$$scope={dirty:W,ctx:K}),P.$set(ne)},i(K){if(!U){for(let W=0;W<Q.length;W+=1)v(H[W]);v(P.$$.fragment,K),U=!0}},o(K){H=H.filter(Boolean);for(let W=0;W<H.length;W+=1)C(H[W]);C(P.$$.fragment,K),U=!1},d(K){K&&m(e),Xe(H,K),M(P),D=!1,it(Z)}}}function Hn(l){let e,n,t;function s(o){l[10](o)}let r={$$slots:{default:[Un]},$$scope:{ctx:l}};return l[1]!==void 0&&(r.dialog=l[1]),e=new zt({props:r}),ke.push(()=>Le(e,"dialog",s)),e.$on("close",l[6]),{c(){R(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,i){L(e,o,i),t=!0},p(o,[i]){const a={};i&16413&&(a.$$scope={dirty:i,ctx:o}),!n&&i&2&&(n=!0,a.dialog=o[1],Fe(()=>n=!1)),e.$set(a)},i(o){t||(v(e.$$.fragment,o),t=!0)},o(o){C(e.$$.fragment,o),t=!1},d(o){M(e,o)}}}function qn(l,e,n){let t,{dialog:s}=e,{name:r=""}=e,{description:o=""}=e,{tags:i}=e;const a=Ve(),c=()=>s.close();function u(){r=this.value,n(0,r)}function p(){o=this.value,n(2,o)}const f=()=>{a("submit",{name:r,description:o,tags:i.map(({modifier:_,name:b})=>({modifier:_,name:b}))}),c()};function k(_){s=_,n(1,s)}return l.$$set=_=>{"dialog"in _&&n(1,s=_.dialog),"name"in _&&n(0,r=_.name),"description"in _&&n(2,o=_.description),"tags"in _&&n(3,i=_.tags)},l.$$.update=()=>{l.$$.dirty&9&&n(4,t=typeof r=="string"&&r!==""&&i.length>1)},[r,s,o,i,t,a,c,u,p,f,k]}class Kn extends ce{constructor(e){super(),ue(this,e,qn,Hn,ae,{dialog:1,name:0,description:2,tags:3})}}function Wn(l){let e,n,t,s,r,o,i,a,c,u;return{c(){e=E("div"),n=E("div"),t=E("i"),s=N(),r=E("div"),o=E("h3"),i=re(l[0]),a=N(),c=E("span"),u=re(l[2]),this.h()},l(p){e=S(p,"DIV",{class:!0});var f=A(e);n=S(f,"DIV",{class:!0});var k=A(n);t=S(k,"I",{class:!0}),A(t).forEach(m),k.forEach(m),s=O(f),r=S(f,"DIV",{});var _=A(r);o=S(_,"H3",{class:!0});var b=A(o);i=oe(b,l[0]),b.forEach(m),a=O(_),c=S(_,"SPAN",{});var B=A(c);u=oe(B,l[2]),B.forEach(m),_.forEach(m),f.forEach(m),this.h()},h(){g(t,"class",Mt(l[1])+" svelte-1yohziu"),g(n,"class","icon svelte-1yohziu"),g(o,"class","svelte-1yohziu"),g(e,"class","error svelte-1yohziu")},m(p,f){j(p,e,f),d(e,n),d(n,t),d(e,s),d(e,r),d(r,o),d(o,i),d(r,a),d(r,c),d(c,u)},p:te,i:te,o:te,d(p){p&&m(e)}}}function Jn(l,e,n){let{error:t}=e,s=t.message==="Failed to fetch"?"Connection Error":"Application Error",r=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",o=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=i=>{"error"in i&&n(3,t=i.error)},[s,r,o,t]}class Qn extends ce{constructor(e){super(),ue(this,e,Jn,Wn,ae,{error:3})}}function Yn(l){let e,n,t,s,r="You have seen everything there is to see...";return{c(){e=E("img"),t=N(),s=E("p"),s.textContent=r,this.h()},l(o){e=S(o,"IMG",{src:!0,alt:!0,class:!0}),t=O(o),s=S(o,"P",{"data-svelte-h":!0}),ie(s)!=="svelte-1i75mtf"&&(s.textContent=r),this.h()},h(){we(e.src,n=Ht+"/assets/shironeko-x.png")||g(e,"src",n),g(e,"alt","No more results to load"),g(e,"class","svelte-1pkma0d")},m(o,i){j(o,e,i),j(o,t,i),j(o,s,i)},p:te,i:te,o:te,d(o){o&&(m(e),m(t),m(s))}}}class Zn extends ce{constructor(e){super(),ue(this,e,null,Yn,ae,{})}}const st=l=>`post_${l}`;function mt(l){let e;const n=l[4].default,t=on(n,l,l[3],null);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,r){t&&t.m(s,r),e=!0},p(s,r){t&&t.p&&(!e||r&8)&&an(t,n,s,s[3],e?un(n,s[3],r,null):cn(s[3]),null)},i(s){e||(v(t,s),e=!0)},o(s){C(t,s),e=!1},d(s){t&&t.d(s)}}}function Xn(l){let e,n,t,s,r=l[1]&&mt(l);return{c(){e=E("div"),r&&r.c(),this.h()},l(o){e=S(o,"DIV",{role:!0,tabindex:!0,class:!0});var i=A(e);r&&r.l(i),i.forEach(m),this.h()},h(){g(e,"role","none"),g(e,"tabindex","-1"),g(e,"class","svelte-6sy8qz")},m(o,i){j(o,e,i),r&&r.m(e,null),l[5](e),n=!0,t||(s=[me(e,"click",rn(xn)),me(e,"keydown",l[2])],t=!0)},p(o,[i]){o[1]?r?(r.p(o,i),i&2&&v(r,1)):(r=mt(o),r.c(),v(r,1),r.m(e,null)):r&&(pe(),C(r,1,1,()=>{r=null}),_e())},i(o){n||(v(r),n=!0)},o(o){C(r),n=!1},d(o){o&&m(e),r&&r.d(),l[5](null),t=!1,it(s)}}}const xn=()=>{};function es(l,e,n){let{$$slots:t={},$$scope:s}=e;const r=Ve(),o=()=>r("close"),i=f=>{f.key==="Escape"&&o()},a=()=>{document.fullscreenElement||o()};let c,u=!1;lt(async()=>{c.focus(),document.addEventListener("fullscreenchange",a);try{await c.requestFullscreen()}catch{}n(1,u=!0)}),rt(async()=>{document.removeEventListener("fullscreenchange",a);try{await document.exitFullscreen()}catch{}});function p(f){ke[f?"unshift":"push"](()=>{c=f,n(0,c)})}return l.$$set=f=>{"$$scope"in f&&n(3,s=f.$$scope)},[c,u,i,s,t,p]}class ts extends ce{constructor(e){super(),ue(this,e,es,Xn,ae,{})}}function ns(l){let e,n;return{c(){e=E("div"),this.h()},l(t){e=S(t,"DIV",{style:!0}),A(e).forEach(m),this.h()},h(){g(e,"style",n=l[0]?`position:absolute;top:${l[0]};`:void 0)},m(t,s){j(t,e,s),l[3](e)},p(t,[s]){s&1&&n!==(n=t[0]?`position:absolute;top:${t[0]};`:void 0)&&g(e,"style",n)},i:te,o:te,d(t){t&&m(e),l[3](null)}}}function ss(l,e,n){let{rootMargin:t}=e,{absoluteTop:s}=e;const r=Ve(),o=new IntersectionObserver(c=>{c[0].isIntersecting&&r("intersection")},{rootMargin:t});let i;function a(c){ke[c?"unshift":"push"](()=>{i=c,n(1,i)})}return l.$$set=c=>{"rootMargin"in c&&n(2,t=c.rootMargin),"absoluteTop"in c&&n(0,s=c.absoluteTop)},l.$$.update=()=>{l.$$.dirty&2&&(o.disconnect(),i&&o.observe(i))},[s,i,t,a]}class tn extends ce{constructor(e){super(),ue(this,e,ss,ns,ae,{rootMargin:2,absoluteTop:0})}}function ht(l,e,n){const t=l.slice();return t[4]=e[n][0],t[5]=e[n][1],t}function $t(l){let e,n="•",t,s,r;return s=new Jt({props:{source:l[0].source}}),{c(){e=E("span"),e.textContent=n,t=N(),R(s.$$.fragment)},l(o){e=S(o,"SPAN",{"data-svelte-h":!0}),ie(e)!=="svelte-7hh8jk"&&(e.textContent=n),t=O(o),F(s.$$.fragment,o)},m(o,i){j(o,e,i),j(o,t,i),L(s,o,i),r=!0},p(o,i){const a={};i&1&&(a.source=o[0].source),s.$set(a)},i(o){r||(v(s.$$.fragment,o),r=!0)},o(o){C(s.$$.fragment,o),r=!1},d(o){o&&(m(e),m(t)),M(s,o)}}}function vt(l){let e,n=l[4]+"",t,s,r,o;return r=new Yt({props:{tags:l[5]}}),{c(){e=E("h3"),t=re(n),s=N(),R(r.$$.fragment),this.h()},l(i){e=S(i,"H3",{class:!0});var a=A(e);t=oe(a,n),a.forEach(m),s=O(i),F(r.$$.fragment,i),this.h()},h(){g(e,"class","svelte-1tsjp7g")},m(i,a){j(i,e,a),d(e,t),j(i,s,a),L(r,i,a),o=!0},p(i,a){(!o||a&2)&&n!==(n=i[4]+"")&&Te(t,n);const c={};a&2&&(c.tags=i[5]),r.$set(c)},i(i){o||(v(r.$$.fragment,i),o=!0)},o(i){C(r.$$.fragment,i),o=!1},d(i){i&&(m(e),m(s)),M(r,i)}}}function ls(l){let e,n,t,s,r,o,i,a,c=l[0].id+"",u,p,f,k,_,b,B="•",h,$,w=l[0].type.toUpperCase()+"",y,z,J,V="•",I,T,P,U,D="•",Z,Q,H,x,K,W,ne,ee="•",be,ye,Ae,Ce,xe="•",et,Se,tt,Ke,q,X,he,Pe="Comments",Ie,de,Ne;k=new bn({props:{value:l[0].rating}}),T=new qt({props:{value:l[0].score}}),Q=new Kt({props:{value:l[0].change}}),K=new Wt({props:{url:"/post?id="+l[0].id+"&src="+encodeURIComponent(l[3])}}),ye=new Jt({props:{source:"https://rule34.xxx/index.php?page=post&s=view&id="+l[0].id}}),Se=new kn({props:{url:l[3]}});let le=l[0].source&&$t(l),Ue=Ee(Object.entries(l[1])),se=[];for(let G=0;G<Ue.length;G+=1)se[G]=vt(ht(l,Ue,G));const ln=G=>C(se[G],1,1,()=>{se[G]=null});return de=new Qt({props:{post:l[0]}}),{c(){e=E("div"),n=E("img"),s=N(),r=E("h1"),o=re("Post "),i=E("b"),a=re("#"),u=re(c),p=N(),f=E("div"),R(k.$$.fragment),_=N(),b=E("span"),b.textContent=B,h=N(),$=E("span"),y=re(w),z=N(),J=E("span"),J.textContent=V,I=N(),R(T.$$.fragment),P=N(),U=E("span"),U.textContent=D,Z=N(),R(Q.$$.fragment),H=N(),x=E("div"),R(K.$$.fragment),W=N(),ne=E("span"),ne.textContent=ee,be=N(),R(ye.$$.fragment),Ae=N(),Ce=E("span"),Ce.textContent=xe,et=N(),R(Se.$$.fragment),tt=N(),le&&le.c(),Ke=N(),q=E("div");for(let G=0;G<se.length;G+=1)se[G].c();X=N(),he=E("h3"),he.textContent=Pe,Ie=N(),R(de.$$.fragment),this.h()},l(G){e=S(G,"DIV",{class:!0});var Y=A(e);n=S(Y,"IMG",{class:!0,src:!0,alt:!0}),s=O(Y),r=S(Y,"H1",{class:!0});var De=A(r);o=oe(De,"Post "),i=S(De,"B",{});var We=A(i);a=oe(We,"#"),u=oe(We,c),We.forEach(m),De.forEach(m),p=O(Y),f=S(Y,"DIV",{class:!0});var ge=A(f);F(k.$$.fragment,ge),_=O(ge),b=S(ge,"SPAN",{"data-svelte-h":!0}),ie(b)!=="svelte-7hh8jk"&&(b.textContent=B),h=O(ge),$=S(ge,"SPAN",{});var nt=A($);y=oe(nt,w),nt.forEach(m),z=O(ge),J=S(ge,"SPAN",{"data-svelte-h":!0}),ie(J)!=="svelte-7hh8jk"&&(J.textContent=V),I=O(ge),F(T.$$.fragment,ge),P=O(ge),U=S(ge,"SPAN",{"data-svelte-h":!0}),ie(U)!=="svelte-7hh8jk"&&(U.textContent=D),Z=O(ge),F(Q.$$.fragment,ge),ge.forEach(m),H=O(Y),x=S(Y,"DIV",{class:!0});var $e=A(x);F(K.$$.fragment,$e),W=O($e),ne=S($e,"SPAN",{"data-svelte-h":!0}),ie(ne)!=="svelte-7hh8jk"&&(ne.textContent=ee),be=O($e),F(ye.$$.fragment,$e),Ae=O($e),Ce=S($e,"SPAN",{"data-svelte-h":!0}),ie(Ce)!=="svelte-7hh8jk"&&(Ce.textContent=xe),et=O($e),F(Se.$$.fragment,$e),tt=O($e),le&&le.l($e),$e.forEach(m),Ke=O(Y),q=S(Y,"DIV",{});var Re=A(q);for(let Je=0;Je<se.length;Je+=1)se[Je].l(Re);X=O(Re),he=S(Re,"H3",{class:!0,"data-svelte-h":!0}),ie(he)!=="svelte-kc6sae"&&(he.textContent=Pe),Ie=O(Re),F(de.$$.fragment,Re),Re.forEach(m),Y.forEach(m),this.h()},h(){g(n,"class","preview svelte-1tsjp7g"),we(n.src,t=l[2])||g(n,"src",t),g(n,"alt","preview"),g(r,"class","svelte-1tsjp7g"),g(f,"class","flex-row svelte-1tsjp7g"),g(x,"class","flex-row svelte-1tsjp7g"),g(he,"class","svelte-1tsjp7g"),g(e,"class","details svelte-1tsjp7g")},m(G,Y){j(G,e,Y),d(e,n),d(e,s),d(e,r),d(r,o),d(r,i),d(i,a),d(i,u),d(e,p),d(e,f),L(k,f,null),d(f,_),d(f,b),d(f,h),d(f,$),d($,y),d(f,z),d(f,J),d(f,I),L(T,f,null),d(f,P),d(f,U),d(f,Z),L(Q,f,null),d(e,H),d(e,x),L(K,x,null),d(x,W),d(x,ne),d(x,be),L(ye,x,null),d(x,Ae),d(x,Ce),d(x,et),L(Se,x,null),d(x,tt),le&&le.m(x,null),d(e,Ke),d(e,q);for(let De=0;De<se.length;De+=1)se[De]&&se[De].m(q,null);d(q,X),d(q,he),d(q,Ie),L(de,q,null),Ne=!0},p(G,[Y]){(!Ne||Y&4&&!we(n.src,t=G[2]))&&g(n,"src",t),(!Ne||Y&1)&&c!==(c=G[0].id+"")&&Te(u,c);const De={};Y&1&&(De.value=G[0].rating),k.$set(De),(!Ne||Y&1)&&w!==(w=G[0].type.toUpperCase()+"")&&Te(y,w);const We={};Y&1&&(We.value=G[0].score),T.$set(We);const ge={};Y&1&&(ge.value=G[0].change),Q.$set(ge);const nt={};Y&9&&(nt.url="/post?id="+G[0].id+"&src="+encodeURIComponent(G[3])),K.$set(nt);const $e={};Y&1&&($e.source="https://rule34.xxx/index.php?page=post&s=view&id="+G[0].id),ye.$set($e);const Re={};if(Y&8&&(Re.url=G[3]),Se.$set(Re),G[0].source?le?(le.p(G,Y),Y&1&&v(le,1)):(le=$t(G),le.c(),v(le,1),le.m(x,null)):le&&(pe(),C(le,1,1,()=>{le=null}),_e()),Y&2){Ue=Ee(Object.entries(G[1]));let ve;for(ve=0;ve<Ue.length;ve+=1){const ut=ht(G,Ue,ve);se[ve]?(se[ve].p(ut,Y),v(se[ve],1)):(se[ve]=vt(ut),se[ve].c(),v(se[ve],1),se[ve].m(q,X))}for(pe(),ve=Ue.length;ve<se.length;ve+=1)ln(ve);_e()}const Je={};Y&1&&(Je.post=G[0]),de.$set(Je)},i(G){if(!Ne){v(k.$$.fragment,G),v(T.$$.fragment,G),v(Q.$$.fragment,G),v(K.$$.fragment,G),v(ye.$$.fragment,G),v(Se.$$.fragment,G),v(le);for(let Y=0;Y<Ue.length;Y+=1)v(se[Y]);v(de.$$.fragment,G),Ne=!0}},o(G){C(k.$$.fragment,G),C(T.$$.fragment,G),C(Q.$$.fragment,G),C(K.$$.fragment,G),C(ye.$$.fragment,G),C(Se.$$.fragment,G),C(le),se=se.filter(Boolean);for(let Y=0;Y<se.length;Y+=1)C(se[Y]);C(de.$$.fragment,G),Ne=!1},d(G){G&&m(e),M(k),M(T),M(Q),M(K),M(ye),M(Se),le&&le.d(),Xe(se,G),M(de)}}}function rs(l,e,n){let t,s,r,{post:o}=e;return l.$$set=i=>{"post"in i&&n(0,o=i.post)},l.$$.update=()=>{l.$$.dirty&1&&n(3,t=o.file_url),l.$$.dirty&1&&n(2,s=o.sample_url),l.$$.dirty&1&&n(1,r=o.tags.reduce((i,a)=>(i[a.type]===void 0&&(i[a.type]=[]),i[a.type].push(a),i),{}))},[o,r,s,t]}class os extends ce{constructor(e){super(),ue(this,e,rs,ls,ae,{post:0})}}const Qe=new IntersectionObserver(l=>{for(const e of l)if(e.target){const n=e.target;e.isIntersecting&&n.autoplay&&n.paused&&n.play(),!e.isIntersecting&&!n.paused&&n.pause()}},{rootMargin:"-1px",threshold:.001});function is(l){const e=l.slice(),n=wn(e[0].file_url,e[0].sample_url,e[0].preview_url);e[5]=n;const t=e[5].animated;return e[6]=t,e}function as(l){const e=l.slice(),n=Zt(e[0].file_url,e[0].sample_url,e[0].preview_url);e[5]=n;const t=e[5].animated;e[6]=t;const s=e[5].static;return e[7]=s,e}function cs(l){const e=l.slice(),n=e[0].sample_url;return e[4]=n,e}function us(l){let e,n,t,s;return{c(){e=E("img"),this.h()},l(r){e=S(r,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){we(e.src,n=l[6])||g(e,"src",n),g(e,"alt",t="[GIF] post #"+l[0].id),g(e,"title",s="[GIF] post #"+l[0].id),g(e,"class","svelte-lra0af")},m(r,o){j(r,e,o)},p(r,o){o&1&&!we(e.src,n=r[6])&&g(e,"src",n),o&1&&t!==(t="[GIF] post #"+r[0].id)&&g(e,"alt",t),o&1&&s!==(s="[GIF] post #"+r[0].id)&&g(e,"title",s)},d(r){r&&m(e)}}}function bt(l){let e,n,t,s;return{c(){e=E("video"),this.h()},l(r){e=S(r,"VIDEO",{src:!0,poster:!0,title:!0,preload:!0,class:!0}),A(e).forEach(m),this.h()},h(){we(e.src,n=l[6])||g(e,"src",n),g(e,"poster",t=l[7]),e.loop=!0,g(e,"title",s="[VIDEO] post #"+l[0].id),e.controls=!0,g(e,"preload","metadata"),e.autoplay=!0,g(e,"class","svelte-lra0af")},m(r,o){j(r,e,o),l[2](e)},p(r,o){o&1&&!we(e.src,n=r[6])&&g(e,"src",n),o&1&&t!==(t=r[7])&&g(e,"poster",t),o&1&&s!==(s="[VIDEO] post #"+r[0].id)&&g(e,"title",s)},d(r){r&&m(e),l[2](null)}}}function kt(l){let e,n,t,s;return{c(){e=E("img"),this.h()},l(r){e=S(r,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){we(e.src,n=l[4])||g(e,"src",n),g(e,"alt",t="[IMAGE] post #"+l[0].id),g(e,"title",s="[IMAGE] post #"+l[0].id),g(e,"class","svelte-lra0af")},m(r,o){j(r,e,o)},p(r,o){o&1&&!we(e.src,n=r[4])&&g(e,"src",n),o&1&&t!==(t="[IMAGE] post #"+r[0].id)&&g(e,"alt",t),o&1&&s!==(s="[IMAGE] post #"+r[0].id)&&g(e,"title",s)},d(r){r&&m(e)}}}function fs(l){let e;function n(o,i){return o[0].type==="image"?kt:o[0].type==="video"?bt:us}function t(o,i){return i===kt?cs(o):i===bt?as(o):is(o)}let s=n(l),r=s(t(l,s));return{c(){e=E("div"),r.c()},l(o){e=S(o,"DIV",{});var i=A(e);r.l(i),i.forEach(m)},m(o,i){j(o,e,i),r.m(e,null)},p(o,[i]){s===(s=n(o))&&r?r.p(t(o,s),i):(r.d(1),r=s(t(o,s)),r&&(r.c(),r.m(e,null)))},i:te,o:te,d(o){o&&m(e),r.d()}}}function ps(l,e,n){let{post:t}=e,s;const r=i=>{t.type==="video"&&s&&(i.key==="ArrowLeft"&&(i.preventDefault(),i.stopPropagation(),n(1,s.currentTime=Math.max(0,s.currentTime-5),s)),i.key==="ArrowRight"&&(i.preventDefault(),i.stopPropagation(),n(1,s.currentTime=Math.min(s.duration,s.currentTime+5),s)))};lt(()=>{s&&(Qe==null||Qe.observe(s)),document.addEventListener("keydown",r)}),rt(()=>{s&&(Qe==null||Qe.unobserve(s)),document.removeEventListener("keydown",r)});function o(i){ke[i?"unshift":"push"](()=>{s=i,n(1,s)})}return l.$$set=i=>{"post"in i&&n(0,t=i.post)},[t,s,o]}class _s extends ce{constructor(e){super(),ue(this,e,ps,fs,ae,{post:0})}}function gs(l){let e,n,t;return{c(){e=E("img"),this.h()},l(s){e=S(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){we(e.src,n=l[2])||g(e,"src",n),g(e,"alt",t="post #"+l[0].id),g(e,"class","svelte-itxz72"),Ge(e,"top",l[1])},m(s,r){j(s,e,r)},p(s,[r]){r&4&&!we(e.src,n=s[2])&&g(e,"src",n),r&1&&t!==(t="post #"+s[0].id)&&g(e,"alt",t),r&2&&Ge(e,"top",s[1])},i:te,o:te,d(s){s&&m(e)}}}function ds(l,e,n){let t,{post:s}=e,{offset:r}=e;return l.$$set=o=>{"post"in o&&n(0,s=o.post),"offset"in o&&n(1,r=o.offset)},l.$$.update=()=>{l.$$.dirty&1&&n(2,t=yn(s.sample_url)?s.preview_url:s.sample_url)},[s,r,t]}class nn extends ce{constructor(e){super(),ue(this,e,ds,gs,ae,{post:0,offset:1})}}const ms=()=>{const{subscribe:e,set:n}=In(Dn.FullscreenHintDone,!1,Pn,Tn);return{subscribe:e,set:n,reset:()=>n(!1)}},wt=ms();function yt(l,e,n){const t=l.slice();return t[17]=e[n],t[19]=n,t}function Ct(l){let e,n;return e=new nn({props:{post:l[3],offset:l[6]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},p(t,s){const r={};s&8&&(r.post=t[3]),s&64&&(r.offset=t[6]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Et(l){let e,n;return e=new nn({props:{post:l[4],offset:l[7]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},p(t,s){const r={};s&16&&(r.post=t[4]),s&128&&(r.offset=t[7]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function St(l){let e,n=`${l[19]*100}vh`;return{c(){e=E("div"),this.h()},l(t){e=S(t,"DIV",{class:!0}),A(e).forEach(m),this.h()},h(){g(e,"class","pseudo snap-item svelte-ed0gda"),Ge(e,"top",n)},m(t,s){j(t,e,s)},p:te,d(t){t&&m(e)}}}function hs(l){let e,n,t,s,r,o,i,a,c,u,p,f,k,_=l[3]&&Ct(l);s=new _s({props:{post:l[2]}}),o=new os({props:{post:l[2]}});let b=l[4]&&Et(l),B=Ee({length:l[9].posts.length}),h=[];for(let $=0;$<B.length;$+=1)h[$]=St(yt(l,B,$));return u=new tn({props:{absoluteTop:l[9].posts.length*100+"vh",rootMargin:window.innerHeight*3+"px"}}),u.$on("intersection",l[14]),{c(){e=E("div"),_&&_.c(),n=N(),t=E("div"),R(s.$$.fragment),r=N(),R(o.$$.fragment),i=N(),b&&b.c(),a=N();for(let $=0;$<h.length;$+=1)h[$].c();c=N(),R(u.$$.fragment),this.h()},l($){e=S($,"DIV",{class:!0});var w=A(e);_&&_.l(w),n=O(w),t=S(w,"DIV",{class:!0});var y=A(t);F(s.$$.fragment,y),r=O(y),F(o.$$.fragment,y),y.forEach(m),i=O(w),b&&b.l(w),a=O(w);for(let z=0;z<h.length;z+=1)h[z].l(w);c=O(w),F(u.$$.fragment,w),w.forEach(m),this.h()},h(){g(t,"class","screen snap-container horizontal current svelte-ed0gda"),Oe(t,"hint",!l[8]),Ge(t,"top",l[5]),g(e,"class","root screen snap-container svelte-ed0gda")},m($,w){j($,e,w),_&&_.m(e,null),d(e,n),d(e,t),L(s,t,null),d(t,r),L(o,t,null),l[13](t),d(e,i),b&&b.m(e,null),d(e,a);for(let y=0;y<h.length;y+=1)h[y]&&h[y].m(e,null);d(e,c),L(u,e,null),l[15](e),p=!0,f||(k=me(e,"scroll",l[11]),f=!0)},p($,[w]){$[3]?_?(_.p($,w),w&8&&v(_,1)):(_=Ct($),_.c(),v(_,1),_.m(e,n)):_&&(pe(),C(_,1,1,()=>{_=null}),_e());const y={};w&4&&(y.post=$[2]),s.$set(y);const z={};if(w&4&&(z.post=$[2]),o.$set(z),(!p||w&256)&&Oe(t,"hint",!$[8]),w&32&&Ge(t,"top",$[5]),$[4]?b?(b.p($,w),w&16&&v(b,1)):(b=Et($),b.c(),v(b,1),b.m(e,a)):b&&(pe(),C(b,1,1,()=>{b=null}),_e()),w&512){B=Ee({length:$[9].posts.length});let V;for(V=0;V<B.length;V+=1){const I=yt($,B,V);h[V]?h[V].p(I,w):(h[V]=St(I),h[V].c(),h[V].m(e,c))}for(;V<h.length;V+=1)h[V].d(1);h.length=B.length}const J={};w&512&&(J.absoluteTop=$[9].posts.length*100+"vh"),u.$set(J)},i($){p||(v(_),v(s.$$.fragment,$),v(o.$$.fragment,$),v(b),v(u.$$.fragment,$),p=!0)},o($){C(_),C(s.$$.fragment,$),C(o.$$.fragment,$),C(b),C(u.$$.fragment,$),p=!1},d($){$&&m(e),_&&_.d(),M(s),M(o),l[13](null),b&&b.d(),Xe(h,$),M(u),l[15](null),f=!1,k()}}}function $s(l,e,n){let t,s;fe(l,wt,y=>n(8,t=y)),fe(l,Ye,y=>n(9,s=y));let{index:r}=e,o,i,a=s.posts[r],c=r>0?s.posts[r-1]:void 0,u=r<s.posts.length-1?s.posts[r+1]:void 0,p=`${r*100}vh`,f=`${(r-1)*100}vh`,k=`${(r+1)*100}vh`;const _=Ve(),b=y=>{requestAnimationFrame(()=>{const z=y.target,J=z.getBoundingClientRect().height,V=z.scrollTop/J,I=Math.round(V);I!=r&&(n(12,r=I),n(2,a=s.posts[r]),n(3,c=r>0?s.posts[r-1]:void 0),n(4,u=r<s.posts.length-1?s.posts[r+1]:void 0),n(5,p=`${r*100}vh`),n(6,f=`${(r-1)*100}vh`),n(7,k=`${(r+1)*100}vh`),i&&n(1,i.scrollLeft=0,i))})},B=y=>{y.key==="d"&&(y.preventDefault(),y.stopPropagation(),i.scrollLeft===0?i.scrollBy({left:o.clientWidth,top:0,behavior:"smooth"}):i.scrollBy({left:-o.clientWidth,top:0,behavior:"smooth"})),y.key==="ArrowUp"&&(y.preventDefault(),y.stopPropagation(),o.scrollTo({left:0,top:o.clientHeight*(r-1),behavior:"smooth"})),y.key==="ArrowDown"&&(y.preventDefault(),y.stopPropagation(),o.scrollTo({left:0,top:o.clientHeight*(r+1),behavior:"smooth"}))};lt(()=>{i&&(i.scrollIntoView(!0),n(1,i.scrollLeft=0,i)),document.addEventListener("keydown",B)}),rt(()=>{Vt(wt,t=!0,t),document.removeEventListener("keydown",B)});function h(y){ke[y?"unshift":"push"](()=>{i=y,n(1,i)})}const $=()=>{_("endreached")};function w(y){ke[y?"unshift":"push"](()=>{o=y,n(0,o)})}return l.$$set=y=>{"index"in y&&n(12,r=y.index)},[o,i,a,c,u,p,f,k,t,s,_,b,r,h,$,w]}class vs extends ce{constructor(e){super(),ue(this,e,$s,hs,ae,{index:12})}}function bs(l){let e;return{c(){e=E("i"),this.h()},l(n){e=S(n,"I",{class:!0}),A(e).forEach(m),this.h()},h(){g(e,"class","codicon codicon-close")},m(n,t){j(n,e,t)},p:te,d(n){n&&m(e)}}}function ks(l){let e,n,t,s,r;function o(a){l[2](a)}let i={};return l[0]!==void 0&&(i.index=l[0]),e=new vs({props:i}),ke.push(()=>Le(e,"index",o)),e.$on("endreached",l[3]),s=new $n({props:{class:"button-close",$$slots:{default:[bs]},$$scope:{ctx:l}}}),s.$on("click",l[1]),{c(){R(e.$$.fragment),t=N(),R(s.$$.fragment)},l(a){F(e.$$.fragment,a),t=O(a),F(s.$$.fragment,a)},m(a,c){L(e,a,c),j(a,t,c),L(s,a,c),r=!0},p(a,c){const u={};!n&&c&1&&(n=!0,u.index=a[0],Fe(()=>n=!1)),e.$set(u);const p={};c&128&&(p.$$scope={dirty:c,ctx:a}),s.$set(p)},i(a){r||(v(e.$$.fragment,a),v(s.$$.fragment,a),r=!0)},o(a){C(e.$$.fragment,a),C(s.$$.fragment,a),r=!1},d(a){a&&m(t),M(e,a),M(s,a)}}}function ws(l){let e,n;return e=new ts({props:{$$slots:{default:[ks]},$$scope:{ctx:l}}}),e.$on("close",l[1]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},p(t,[s]){const r={};s&129&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function ys(l,e,n){let{index:t}=e;const s=Ve(),r=()=>{s("close",t)},o=u=>{u.key==="f"&&(u.preventDefault(),u.stopPropagation(),r())},i=()=>{var u,p;(((u=history.state)==null?void 0:u.fullscreen)===void 0||((p=history.state)==null?void 0:p.fullscreen)===!1)&&r()};lt(()=>{window.addEventListener("popstate",i),document.addEventListener("keydown",o)}),rt(()=>{window.removeEventListener("popstate",i),document.removeEventListener("keydown",o)});function a(u){t=u,n(0,t)}function c(u){Ze.call(this,l,u)}return l.$$set=u=>{"index"in u&&n(0,t=u.index)},[t,r,a,c]}class Cs extends ce{constructor(e){super(),ue(this,e,ys,ws,ae,{index:0})}}function It(l){let e,n=l[0].type==="video"?"▶":"GIF",t;return{c(){e=E("span"),t=re(n),this.h()},l(s){e=S(s,"SPAN",{class:!0});var r=A(e);t=oe(r,n),r.forEach(m),this.h()},h(){g(e,"class","type svelte-rfj0jo")},m(s,r){j(s,e,r),d(e,t)},p(s,r){r&1&&n!==(n=s[0].type==="video"?"▶":"GIF")&&Te(t,n)},d(s){s&&m(e)}}}function Es(l){let e,n,t,s,r,o,i=Me(l[0].score)+"",a,c,u,p,f=l[0].type!=="image"&&It(l);return{c(){e=E("div"),n=E("img"),s=N(),f&&f.c(),r=N(),o=E("span"),a=re(i),this.h()},l(k){e=S(k,"DIV",{id:!0,class:!0,style:!0});var _=A(e);n=S(_,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),s=O(_),f&&f.l(_),r=O(_),o=S(_,"SPAN",{class:!0});var b=A(o);a=oe(b,i),b.forEach(m),_.forEach(m),this.h()},h(){we(n.src,t=l[1])||g(n,"src",t),g(n,"alt","post"),g(n,"class","post-media svelte-rfj0jo"),g(n,"tabindex","-1"),g(n,"loading","lazy"),g(o,"class","score svelte-rfj0jo"),g(e,"id",c=st(l[0].id)),g(e,"class","post svelte-rfj0jo"),Ge(e,"grid-row","span "+l[2]),Oe(e,"open",open)},m(k,_){j(k,e,_),d(e,n),d(e,s),f&&f.m(e,null),d(e,r),d(e,o),d(o,a),u||(p=[me(e,"click",l[3]),me(e,"keydown",l[4])],u=!0)},p(k,[_]){_&2&&!we(n.src,t=k[1])&&g(n,"src",t),k[0].type!=="image"?f?f.p(k,_):(f=It(k),f.c(),f.m(e,r)):f&&(f.d(1),f=null),_&1&&i!==(i=Me(k[0].score)+"")&&Te(a,i),_&1&&c!==(c=st(k[0].id))&&g(e,"id",c),_&0&&Oe(e,"open",open)},i:te,o:te,d(k){k&&m(e),f&&f.d(),u=!1,it(p)}}}let Dt=5;function Ss(l,e,n){let t,{post:s}=e,r=1/3,o=s.width/s.height,i=Math.max(Math.min(Math.round(Dt/o),Dt/r),2);console.log(i);const a=p=>p.endsWith(".jpg")||p.endsWith(".jpeg")||p.endsWith(".png")||p.endsWith(".webp");function c(p){Ze.call(this,l,p)}const u=p=>{var f;(Xt(p)||p.key==="f")&&((f=p.target)==null||f.click())};return l.$$set=p=>{"post"in p&&n(0,s=p.post)},l.$$.update=()=>{l.$$.dirty&1&&n(1,t=a(s.sample_url)?s.sample_url:s.preview_url)},[s,t,i,c,u]}class Is extends ce{constructor(e){super(),ue(this,e,Ss,Es,ae,{post:0})}}function Tt(l){let e,n=Me(l[0].comment_count)+"",t,s,r;return{c(){e=E("button"),t=re(n),this.h()},l(o){e=S(o,"BUTTON",{class:!0});var i=A(e);t=oe(i,n),i.forEach(m),this.h()},h(){g(e,"class","codicon codicon-comment svelte-nhpj3u"),Oe(e,"active",l[1]==="comments")},m(o,i){j(o,e,i),d(e,t),s||(r=me(e,"click",l[3]),s=!0)},p(o,i){i&1&&n!==(n=Me(o[0].comment_count)+"")&&Te(t,n),i&2&&Oe(e,"active",o[1]==="comments")},d(o){o&&m(e),s=!1,r()}}}function Ds(l){let e,n,t,s,r="•",o,i,a,c,u="•",p,f,k,_,b,B,h,$=Me(l[0].tags.length)+"",w,y,z,J;n=new Kt({props:{value:l[0].change}}),i=new qt({props:{value:l[0].score}}),f=new Wt({props:{url:"/post?id="+l[0].id+"&src="+encodeURIComponent(l[0].file_url)}});let V=l[0].comment_count&&Tt(l);return{c(){e=E("div"),R(n.$$.fragment),t=N(),s=E("span"),s.textContent=r,o=N(),R(i.$$.fragment),a=N(),c=E("span"),c.textContent=u,p=N(),R(f.$$.fragment),k=N(),_=E("span"),b=N(),V&&V.c(),B=N(),h=E("button"),w=re($),this.h()},l(I){e=S(I,"DIV",{class:!0});var T=A(e);F(n.$$.fragment,T),t=O(T),s=S(T,"SPAN",{"data-svelte-h":!0}),ie(s)!=="svelte-7hh8jk"&&(s.textContent=r),o=O(T),F(i.$$.fragment,T),a=O(T),c=S(T,"SPAN",{"data-svelte-h":!0}),ie(c)!=="svelte-7hh8jk"&&(c.textContent=u),p=O(T),F(f.$$.fragment,T),k=O(T),_=S(T,"SPAN",{class:!0}),A(_).forEach(m),b=O(T),V&&V.l(T),B=O(T),h=S(T,"BUTTON",{class:!0});var P=A(h);w=oe(P,$),P.forEach(m),T.forEach(m),this.h()},h(){g(_,"class","divider svelte-nhpj3u"),g(h,"class","codicon codicon-tag svelte-nhpj3u"),Oe(h,"active",l[1]==="tags"),g(e,"class","summary svelte-nhpj3u")},m(I,T){j(I,e,T),L(n,e,null),d(e,t),d(e,s),d(e,o),L(i,e,null),d(e,a),d(e,c),d(e,p),L(f,e,null),d(e,k),d(e,_),d(e,b),V&&V.m(e,null),d(e,B),d(e,h),d(h,w),y=!0,z||(J=me(h,"click",l[4]),z=!0)},p(I,[T]){const P={};T&1&&(P.value=I[0].change),n.$set(P);const U={};T&1&&(U.value=I[0].score),i.$set(U);const D={};T&1&&(D.url="/post?id="+I[0].id+"&src="+encodeURIComponent(I[0].file_url)),f.$set(D),I[0].comment_count?V?V.p(I,T):(V=Tt(I),V.c(),V.m(e,B)):V&&(V.d(1),V=null),(!y||T&1)&&$!==($=Me(I[0].tags.length)+"")&&Te(w,$),(!y||T&2)&&Oe(h,"active",I[1]==="tags")},i(I){y||(v(n.$$.fragment,I),v(i.$$.fragment,I),v(f.$$.fragment,I),y=!0)},o(I){C(n.$$.fragment,I),C(i.$$.fragment,I),C(f.$$.fragment,I),y=!1},d(I){I&&m(e),M(n),M(i),M(f),V&&V.d(),z=!1,J()}}}function Ts(l,e,n){const t=Ve();let{post:s}=e,{active:r}=e;const o=()=>t("comments"),i=()=>t("tags");return l.$$set=a=>{"post"in a&&n(0,s=a.post),"active"in a&&n(1,r=a.active)},[s,r,t,o,i]}class Ps extends ce{constructor(e){super(),ue(this,e,Ts,Ds,ae,{post:0,active:1})}}function Ns(l){let e,n='<i class="codicon codicon-screen-full"></i>',t,s;return{c(){e=E("button"),e.innerHTML=n,this.h()},l(r){e=S(r,"BUTTON",{type:!0,title:!0,class:!0,"data-svelte-h":!0}),ie(e)!=="svelte-hnv5zq"&&(e.innerHTML=n),this.h()},h(){g(e,"type","button"),g(e,"title","Enter Fullscreen mode"),g(e,"class","svelte-txn4jo")},m(r,o){j(r,e,o),t||(s=me(e,"click",l[0]),t=!0)},p:te,i:te,o:te,d(r){r&&m(e),t=!1,s()}}}function Os(l){function e(n){Ze.call(this,l,n)}return[e]}class js extends ce{constructor(e){super(),ue(this,e,Os,Ns,ae,{})}}function As(l){const e=l.slice(),n=Zt(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[9]=n,e}function Rs(l){let e,n;return e=new Cn({props:{post:l[1]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.post=t[1]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Fs(l){let e,n;return e=new En({props:{src:l[9].animated,poster:l[9].static,width:l[1].width,height:l[1].height,loop:l[2]||pt(l[1].tags)}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.src=t[9].animated),s&2&&(r.poster=t[9].static),s&2&&(r.width=t[1].width),s&2&&(r.height=t[1].height),s&6&&(r.loop=t[2]||pt(t[1].tags)),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Ls(l){let e,n;return e=new Sn({props:{post:l[1]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.post=t[1]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Ms(l){let e,n;return e=new Qt({props:{post:l[1]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.post=t[1]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Vs(l){let e,n;return e=new Yt({props:{tags:l[1].tags}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.tags=t[1].tags),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Bs(l){let e,n,t,s,r,o,i,a,c,u,p,f,k,_,b,B;const h=[Ls,Fs,Rs],$=[];function w(I,T){return I[1].type==="image"?0:I[1].type==="video"?1:2}function y(I,T){return T===1?As(I):I}t=w(l),s=$[t]=h[t](y(l,t)),o=new js({}),o.$on("click",l[5]),c=new Ps({props:{active:l[0],post:l[1]}}),c.$on("tags",l[6]),c.$on("comments",l[7]);const z=[Vs,Ms],J=[];function V(I,T){return I[0]==="tags"?0:I[0]==="comments"?1:-1}return~(p=V(l))&&(f=J[p]=z[p](l)),{c(){e=E("div"),n=E("div"),s.c(),r=N(),R(o.$$.fragment),i=N(),a=E("div"),R(c.$$.fragment),u=N(),f&&f.c(),this.h()},l(I){e=S(I,"DIV",{id:!0,class:!0});var T=A(e);n=S(T,"DIV",{});var P=A(n);s.l(P),P.forEach(m),r=O(T),F(o.$$.fragment,T),i=O(T),a=S(T,"DIV",{class:!0});var U=A(a);F(c.$$.fragment,U),u=O(U),f&&f.l(U),U.forEach(m),T.forEach(m),this.h()},h(){g(a,"class","details svelte-iu0mgu"),g(e,"id",k=st(l[1].id)),g(e,"class","post svelte-iu0mgu"),Oe(e,"openTab",l[0])},m(I,T){j(I,e,T),d(e,n),$[t].m(n,null),d(e,r),L(o,e,null),d(e,i),d(e,a),L(c,a,null),d(a,u),~p&&J[p].m(a,null),_=!0,b||(B=me(e,"keydown",l[8]),b=!0)},p(I,[T]){let P=t;t=w(I),t===P?$[t].p(y(I,t),T):(pe(),C($[P],1,1,()=>{$[P]=null}),_e(),s=$[t],s?s.p(y(I,t),T):(s=$[t]=h[t](y(I,t)),s.c()),v(s,1),s.m(n,null));const U={};T&1&&(U.active=I[0]),T&2&&(U.post=I[1]),c.$set(U);let D=p;p=V(I),p===D?~p&&J[p].p(I,T):(f&&(pe(),C(J[D],1,1,()=>{J[D]=null}),_e()),~p?(f=J[p],f?f.p(I,T):(f=J[p]=z[p](I),f.c()),v(f,1),f.m(a,null)):f=null),(!_||T&2&&k!==(k=st(I[1].id)))&&g(e,"id",k),(!_||T&1)&&Oe(e,"openTab",I[0])},i(I){_||(v(s),v(o.$$.fragment,I),v(c.$$.fragment,I),v(f),_=!0)},o(I){C(s),C(o.$$.fragment,I),C(c.$$.fragment,I),C(f),_=!1},d(I){I&&m(e),$[t].d(),M(o),M(c),~p&&J[p].d(),b=!1,B()}}}function zs(l,e,n){let t;fe(l,Nn,f=>n(2,t=f));const s=Ve();let{post:r}=e,{openTab:o=void 0}=e;const i=f=>{o===f?n(0,o=void 0):n(0,o=f)},a=()=>s("fullscreen"),c=()=>i("tags"),u=()=>i("comments"),p=f=>{f.key==="f"&&s("fullscreen")};return l.$$set=f=>{"post"in f&&n(1,r=f.post),"openTab"in f&&n(0,o=f.openTab)},[o,r,t,s,i,a,c,u,p]}class Gs extends ce{constructor(e){super(),ue(this,e,zs,Bs,ae,{post:1,openTab:0})}}function Pt(l,e,n){const t=l.slice();return t[5]=e[n][0],t[6]=e[n][1],t}function Nt(l){let e,n,t,s=!1,r,o,i,a=l[6]+"",c,u,p,f,k;return p=fn(l[4][0]),{c(){e=E("input"),o=N(),i=E("label"),c=re(a),this.h()},l(_){e=S(_,"INPUT",{type:!0,name:!0,id:!0,class:!0}),o=O(_),i=S(_,"LABEL",{for:!0,class:!0});var b=A(i);c=oe(b,a),b.forEach(m),this.h()},h(){g(e,"type","radio"),g(e,"name",n="group-"+l[1]),e.__value=t=l[5],ze(e,e.__value),g(e,"id",r=l[1]+"-"+l[5]),g(e,"class","svelte-16oxivo"),g(i,"for",u=l[1]+"-"+l[5]),g(i,"class","svelte-16oxivo"),p.p(e)},m(_,b){j(_,e,b),e.checked=e.__value===l[0],j(_,o,b),j(_,i,b),d(i,c),f||(k=me(e,"change",l[3]),f=!0)},p(_,b){b&2&&n!==(n="group-"+_[1])&&g(e,"name",n),b&4&&t!==(t=_[5])&&(e.__value=t,ze(e,e.__value),s=!0),b&6&&r!==(r=_[1]+"-"+_[5])&&g(e,"id",r),(s||b&5)&&(e.checked=e.__value===_[0]),b&4&&a!==(a=_[6]+"")&&Te(c,a),b&6&&u!==(u=_[1]+"-"+_[5])&&g(i,"for",u)},d(_){_&&(m(e),m(o),m(i)),p.r(),f=!1,k()}}}function Us(l){let e,n,t=Ee(Object.entries(l[2])),s=[];for(let r=0;r<t.length;r+=1)s[r]=Nt(Pt(l,t,r));return{c(){e=E("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=S(r,"DIV",{id:!0,role:!0,class:!0});var o=A(e);for(let i=0;i<s.length;i+=1)s[i].l(o);o.forEach(m),this.h()},h(){g(e,"id",n="group-"+l[1]),g(e,"role","radiogroup"),g(e,"class","svelte-16oxivo")},m(r,o){j(r,e,o);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null)},p(r,[o]){if(o&7){t=Ee(Object.entries(r[2]));let i;for(i=0;i<t.length;i+=1){const a=Pt(r,t,i);s[i]?s[i].p(a,o):(s[i]=Nt(a),s[i].c(),s[i].m(e,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=t.length}o&2&&n!==(n="group-"+r[1])&&g(e,"id",n)},i:te,o:te,d(r){r&&m(e),Xe(s,r)}}}function Hs(l,e,n){let{name:t}=e,{value:s}=e,{options:r}=e;const o=[[]];function i(){s=this.__value,n(0,s)}return l.$$set=a=>{"name"in a&&n(1,t=a.name),"value"in a&&n(0,s=a.value),"options"in a&&n(2,r=a.options)},[s,t,r,i,o]}class qs extends ce{constructor(e){super(),ue(this,e,Hs,Us,ae,{name:1,value:0,options:2})}}function Ks(l){let e;return{c(){e=re("Done")},l(n){e=oe(n,"Done")},m(n,t){j(n,e,t)},d(n){n&&m(e)}}}function Ws(l){let e;return{c(){e=re("Reset")},l(n){e=oe(n,"Reset")},m(n,t){j(n,e,t)},d(n){n&&m(e)}}}function Js(l){let e,n,t="Sorting and Filtering",s,r,o,i="Sorting",a,c,u,p,f,k,_,b,B,h,$="Filtering by Score",w,y,z,J,V,I,T,P,U="Filtering by Rating",D,Z,Q,H,x,K,W,ne,ee,be;function ye(q){l[6](q)}let Ae={options:Zs};l[3].direction!==void 0&&(Ae.value=l[3].direction),u=new vn({props:Ae}),ke.push(()=>Le(u,"value",ye));function Ce(q){l[7](q)}let xe={options:Ys};l[3].property!==void 0&&(xe.value=l[3].property),k=new jn({props:xe}),ke.push(()=>Le(k,"value",Ce));function et(q){l[8](q)}let Se={options:Xs};l[2].scoreComparator!==void 0&&(Se.value=l[2].scoreComparator),z=new An({props:Se}),ke.push(()=>Le(z,"value",et));function tt(q){l[10](q)}let Ke={name:"rating",options:sn};return l[2].rating!==void 0&&(Ke.value=l[2].rating),Z=new qs({props:Ke}),ke.push(()=>Le(Z,"value",tt)),x=new qe({props:{title:"Return to searching.",$$slots:{default:[Ks]},$$scope:{ctx:l}}}),x.$on("click",l[11]),W=new qe({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[Ws]},$$scope:{ctx:l}}}),W.$on("click",l[5]),{c(){e=E("div"),n=E("h3"),n.textContent=t,s=N(),r=E("div"),o=E("b"),o.textContent=i,a=N(),c=E("div"),R(u.$$.fragment),f=N(),R(k.$$.fragment),b=N(),B=E("div"),h=E("b"),h.textContent=$,w=N(),y=E("div"),R(z.$$.fragment),V=N(),I=E("input"),T=N(),P=E("b"),P.textContent=U,D=N(),R(Z.$$.fragment),H=N(),R(x.$$.fragment),K=N(),R(W.$$.fragment),this.h()},l(q){e=S(q,"DIV",{class:!0});var X=A(e);n=S(X,"H3",{"data-svelte-h":!0}),ie(n)!=="svelte-15zouq3"&&(n.textContent=t),s=O(X),r=S(X,"DIV",{});var he=A(r);o=S(he,"B",{class:!0,"data-svelte-h":!0}),ie(o)!=="svelte-ekzpgg"&&(o.textContent=i),a=O(he),c=S(he,"DIV",{class:!0});var Pe=A(c);F(u.$$.fragment,Pe),f=O(Pe),F(k.$$.fragment,Pe),Pe.forEach(m),he.forEach(m),b=O(X),B=S(X,"DIV",{});var Ie=A(B);h=S(Ie,"B",{class:!0,"data-svelte-h":!0}),ie(h)!=="svelte-1flca3"&&(h.textContent=$),w=O(Ie),y=S(Ie,"DIV",{class:!0});var de=A(y);F(z.$$.fragment,de),V=O(de),I=S(de,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),de.forEach(m),Ie.forEach(m),T=O(X),P=S(X,"B",{class:!0,"data-svelte-h":!0}),ie(P)!=="svelte-1evbw58"&&(P.textContent=U),D=O(X),F(Z.$$.fragment,X),H=O(X),F(x.$$.fragment,X),K=O(X),F(W.$$.fragment,X),X.forEach(m),this.h()},h(){g(o,"class","svelte-seh1z8"),g(c,"class","row svelte-seh1z8"),g(h,"class","svelte-seh1z8"),g(I,"type","number"),g(I,"min",0),g(I,"max",1e5),g(I,"step",1),g(I,"class","svelte-seh1z8"),g(y,"class","row svelte-seh1z8"),g(P,"class","svelte-seh1z8"),g(e,"class","container svelte-seh1z8")},m(q,X){j(q,e,X),d(e,n),d(e,s),d(e,r),d(r,o),d(r,a),d(r,c),L(u,c,null),d(c,f),L(k,c,null),d(e,b),d(e,B),d(B,h),d(B,w),d(B,y),L(z,y,null),d(y,V),d(y,I),ze(I,l[1]),d(e,T),d(e,P),d(e,D),L(Z,e,null),d(e,H),L(x,e,null),d(e,K),L(W,e,null),ne=!0,ee||(be=[me(I,"input",l[9]),me(I,"keyup",l[4])],ee=!0)},p(q,X){const he={};!p&&X&8&&(p=!0,he.value=q[3].direction,Fe(()=>p=!1)),u.$set(he);const Pe={};!_&&X&8&&(_=!0,Pe.value=q[3].property,Fe(()=>_=!1)),k.$set(Pe);const Ie={};!J&&X&4&&(J=!0,Ie.value=q[2].scoreComparator,Fe(()=>J=!1)),z.$set(Ie),X&2&&Bt(I.value)!==q[1]&&ze(I,q[1]);const de={};!Q&&X&4&&(Q=!0,de.value=q[2].rating,Fe(()=>Q=!1)),Z.$set(de);const Ne={};X&16384&&(Ne.$$scope={dirty:X,ctx:q}),x.$set(Ne);const le={};X&16384&&(le.$$scope={dirty:X,ctx:q}),W.$set(le)},i(q){ne||(v(u.$$.fragment,q),v(k.$$.fragment,q),v(z.$$.fragment,q),v(Z.$$.fragment,q),v(x.$$.fragment,q),v(W.$$.fragment,q),ne=!0)},o(q){C(u.$$.fragment,q),C(k.$$.fragment,q),C(z.$$.fragment,q),C(Z.$$.fragment,q),C(x.$$.fragment,q),C(W.$$.fragment,q),ne=!1},d(q){q&&m(e),M(u),M(k),M(z),M(Z),M(x),M(W),ee=!1,it(be)}}}function Qs(l){let e,n,t;function s(o){l[12](o)}let r={$$slots:{default:[Js]},$$scope:{ctx:l}};return l[0]!==void 0&&(r.dialog=l[0]),e=new zt({props:r}),ke.push(()=>Le(e,"dialog",s)),e.$on("close",l[13]),{c(){R(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,i){L(e,o,i),t=!0},p(o,[i]){const a={};i&16399&&(a.$$scope={dirty:i,ctx:o}),!n&&i&1&&(n=!0,a.dialog=o[0],Fe(()=>n=!1)),e.$set(a)},i(o){t||(v(e.$$.fragment,o),t=!0)},o(o){C(e.$$.fragment,o),t=!1},d(o){M(e,o)}}}const sn=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),Ys=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated",random:"Random"}),Zs=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),Xs=Object.freeze({">=":"≥","<=":"≤"});function xs(l,e,n){let t,s;fe(l,Be,h=>n(2,t=h)),fe(l,He,h=>n(3,s=h));let{dialog:r}=e,o;const i=h=>{var $;return Xt(h)&&(($=h.target)==null?void 0:$.blur())},a=()=>{He.reset(),Be.reset(),n(1,o=t.scoreValue)};function c(h){l.$$.not_equal(s.direction,h)&&(s.direction=h,He.set(s))}function u(h){l.$$.not_equal(s.property,h)&&(s.property=h,He.set(s))}function p(h){l.$$.not_equal(t.scoreComparator,h)&&(t.scoreComparator=h,Be.set(t))}function f(){o=Bt(this.value),n(1,o),n(2,t)}function k(h){l.$$.not_equal(t.rating,h)&&(t.rating=h,Be.set(t))}const _=()=>r.close();function b(h){r=h,n(0,r)}function B(h){Ze.call(this,l,h)}return l.$$set=h=>{"dialog"in h&&n(0,r=h.dialog)},l.$$.update=()=>{if(l.$$.dirty&6){o===void 0&&n(1,o=t.scoreValue);let h=Number(o);isNaN(h)||Vt(Be,t.scoreValue=h,t)}},[r,o,t,s,i,a,c,u,p,f,k,_,b,B]}class el extends ce{constructor(e){super(),ue(this,e,xs,Qs,ae,{dialog:0})}}function tl(l){let e,n,t,s,r,o,i,a,c,u,p,f,k,_,b,B;function h(w){l[9](w)}let $={};return l[2]!==void 0&&($.dialog=l[2]),f=new el({props:$}),ke.push(()=>Le(f,"dialog",h)),f.$on("close",l[10]),{c(){e=E("button"),n=E("i"),t=N(),s=E("span"),r=re(l[5]),o=N(),i=E("i"),a=N(),c=E("span"),u=re(l[4]),p=N(),R(f.$$.fragment),this.h()},l(w){e=S(w,"BUTTON",{class:!0});var y=A(e);n=S(y,"I",{class:!0}),A(n).forEach(m),t=O(y),s=S(y,"SPAN",{class:!0});var z=A(s);r=oe(z,l[5]),z.forEach(m),o=O(y),i=S(y,"I",{class:!0}),A(i).forEach(m),a=O(y),c=S(y,"SPAN",{class:!0});var J=A(c);u=oe(J,l[4]),J.forEach(m),y.forEach(m),p=O(w),F(f.$$.fragment,w),this.h()},h(){g(n,"class","codicon codicon-filter svelte-1ujuzt8"),g(s,"class","svelte-1ujuzt8"),g(i,"class","codicon codicon-arrow-swap svelte-1ujuzt8"),g(c,"class","svelte-1ujuzt8"),g(e,"class","svelte-1ujuzt8")},m(w,y){j(w,e,y),d(e,n),d(e,t),d(e,s),d(s,r),d(e,o),d(e,i),d(e,a),d(e,c),d(c,u),j(w,p,y),L(f,w,y),_=!0,b||(B=me(e,"click",l[8]),b=!0)},p(w,[y]){(!_||y&32)&&Te(r,w[5]),(!_||y&16)&&Te(u,w[4]);const z={};!k&&y&4&&(k=!0,z.dialog=w[2],Fe(()=>k=!1)),f.$set(z)},i(w){_||(v(f.$$.fragment,w),_=!0)},o(w){C(f.$$.fragment,w),_=!1},d(w){w&&(m(e),m(p)),M(f,w),b=!1,B()}}}const nl=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"},random:{asc:"Random",desc:"Random"}}),sl=(l,e,n)=>{let t=l==="all"?void 0:sn[l],s=e===0&&n===">="?void 0:`Score${n}${Me(e)}`;return[t,s].filter(r=>r!==void 0).join(",")||"All"};function ll(l,e,n){let t,s,r,o;fe(l,He,_=>n(0,r=_)),fe(l,Be,_=>n(1,o=_));const i=Ve(),a=(_,b)=>JSON.stringify(Object.assign({},_,b));let c,u="";const p=()=>{n(3,u=a(r,o)),c.showModal(),Gt("dialog")};function f(_){c=_,n(2,c)}const k=()=>{a(r,o)!==u&&i("sortfilterupdate")};return l.$$.update=()=>{l.$$.dirty&2&&n(5,t=sl(o.rating,o.scoreValue,o.scoreComparator)),l.$$.dirty&1&&n(4,s=nl[r.property][r.direction])},[r,o,c,u,s,t,i,a,p,f,k]}class rl extends ce{constructor(e){super(),ue(this,e,ll,tl,ae,{})}}function Ot(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function jt(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function ol(l){let e,n,t=Ee(l[1].posts),s=[];for(let o=0;o<t.length;o+=1)s[o]=At(Ot(l,t,o));const r=o=>C(s[o],1,1,()=>{s[o]=null});return{c(){e=E("ol");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){e=S(o,"OL",{class:!0,style:!0});var i=A(e);for(let a=0;a<s.length;a+=1)s[a].l(i);i.forEach(m),this.h()},h(){g(e,"class","multi-column svelte-1sp0f1c"),Ge(e,"--nr-columns",l[2])},m(o,i){j(o,e,i);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);n=!0},p(o,i){if(i&3){t=Ee(o[1].posts);let a;for(a=0;a<t.length;a+=1){const c=Ot(o,t,a);s[a]?(s[a].p(c,i),v(s[a],1)):(s[a]=At(c),s[a].c(),v(s[a],1),s[a].m(e,null))}for(pe(),a=t.length;a<s.length;a+=1)r(a);_e()}(!n||i&4)&&Ge(e,"--nr-columns",o[2])},i(o){if(!n){for(let i=0;i<t.length;i+=1)v(s[i]);n=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)C(s[i]);n=!1},d(o){o&&m(e),Xe(s,o)}}}function il(l){let e,n,t=Ee(l[1].posts),s=[];for(let o=0;o<t.length;o+=1)s[o]=Rt(jt(l,t,o));const r=o=>C(s[o],1,1,()=>{s[o]=null});return{c(){e=E("ol");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){e=S(o,"OL",{class:!0});var i=A(e);for(let a=0;a<s.length;a+=1)s[a].l(i);i.forEach(m),this.h()},h(){g(e,"class","single-column svelte-1sp0f1c")},m(o,i){j(o,e,i);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);n=!0},p(o,i){if(i&3){t=Ee(o[1].posts);let a;for(a=0;a<t.length;a+=1){const c=jt(o,t,a);s[a]?(s[a].p(c,i),v(s[a],1)):(s[a]=Rt(c),s[a].c(),v(s[a],1),s[a].m(e,null))}for(pe(),a=t.length;a<s.length;a+=1)r(a);_e()}},i(o){if(!n){for(let i=0;i<t.length;i+=1)v(s[i]);n=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)C(s[i]);n=!1},d(o){o&&m(e),Xe(s,o)}}}function At(l){let e,n;function t(){return l[6](l[10])}return e=new Is({props:{post:l[8]}}),e.$on("click",t),{c(){R(e.$$.fragment)},l(s){F(e.$$.fragment,s)},m(s,r){L(e,s,r),n=!0},p(s,r){l=s;const o={};r&2&&(o.post=l[8]),e.$set(o)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){C(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function Rt(l){let e,n;function t(){return l[5](l[10])}return e=new Gs({props:{post:l[8]}}),e.$on("fullscreen",t),{c(){R(e.$$.fragment)},l(s){F(e.$$.fragment,s)},m(s,r){L(e,s,r),n=!0},p(s,r){l=s;const o={};r&2&&(o.post=l[8]),e.$set(o)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){C(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function Ft(l){let e,n;return e=new Cs({props:{index:l[0]}}),e.$on("close",l[3]),e.$on("endreached",l[7]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},p(t,s){const r={};s&1&&(r.index=t[0]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function al(l){let e,n,t=Me(l[1].postCount)+"",s,r,o,i,a,c,u,p,f,k;i=new rl({}),i.$on("sortfilterupdate",l[4]);const _=[il,ol],b=[];function B($,w){return $[2]==="1"?0:1}c=B(l),u=b[c]=_[c](l);let h=l[0]!==void 0&&Ft(l);return{c(){e=E("div"),n=E("span"),s=re(t),r=re(" posts"),o=N(),R(i.$$.fragment),a=N(),u.c(),p=N(),h&&h.c(),f=je(),this.h()},l($){e=S($,"DIV",{class:!0});var w=A(e);n=S(w,"SPAN",{});var y=A(n);s=oe(y,t),r=oe(y," posts"),y.forEach(m),o=O(w),F(i.$$.fragment,w),w.forEach(m),a=O($),u.l($),p=O($),h&&h.l($),f=je(),this.h()},h(){g(e,"class","svelte-1sp0f1c")},m($,w){j($,e,w),d(e,n),d(n,s),d(n,r),d(e,o),L(i,e,null),j($,a,w),b[c].m($,w),j($,p,w),h&&h.m($,w),j($,f,w),k=!0},p($,[w]){(!k||w&2)&&t!==(t=Me($[1].postCount)+"")&&Te(s,t);let y=c;c=B($),c===y?b[c].p($,w):(pe(),C(b[y],1,1,()=>{b[y]=null}),_e(),u=b[c],u?u.p($,w):(u=b[c]=_[c]($),u.c()),v(u,1),u.m(p.parentNode,p)),$[0]!==void 0?h?(h.p($,w),w&1&&v(h,1)):(h=Ft($),h.c(),v(h,1),h.m(f.parentNode,f)):h&&(pe(),C(h,1,1,()=>{h=null}),_e())},i($){k||(v(i.$$.fragment,$),v(u),v(h),k=!0)},o($){C(i.$$.fragment,$),C(u),C(h),k=!1},d($){$&&(m(e),m(a),m(p),m(f)),M(i),b[c].d($),h&&h.d($)}}}function cl(l,e,n){let t,s;fe(l,Ye,p=>n(1,t=p)),fe(l,Ut,p=>n(2,s=p));let r;const o=p=>{var _;const f=t.posts[p.detail],k=st(f.id);(_=document.getElementById(k))==null||_.scrollIntoView(),n(0,r=void 0)};function i(p){Ze.call(this,l,p)}const a=p=>{n(0,r=p)},c=p=>{n(0,r=p)};function u(p){Ze.call(this,l,p)}return l.$$.update=()=>{var p;l.$$.dirty&1&&(r!==void 0?history.pushState({...history.state,fullscreen:!0},""):(p=history.state)!=null&&p.fullscreen&&history.back())},[r,t,s,o,i,a,c,u]}class ul extends ce{constructor(e){super(),ue(this,e,cl,al,ae,{})}}function fl(l){let e;return{c(){e=re("Reset Filter")},l(n){e=oe(n,"Reset Filter")},m(n,t){j(n,e,t)},d(n){n&&m(e)}}}function pl(l){let e,n,t,s,r="We couldn't find any posts matching your tags. Sorry...",o,i,a;return i=new qe({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[fl]},$$scope:{ctx:l}}}),i.$on("click",l[1]),{c(){e=E("img"),t=N(),s=E("p"),s.textContent=r,o=N(),R(i.$$.fragment),this.h()},l(c){e=S(c,"IMG",{src:!0,alt:!0,class:!0}),t=O(c),s=S(c,"P",{"data-svelte-h":!0}),ie(s)!=="svelte-1utxj3w"&&(s.textContent=r),o=O(c),F(i.$$.fragment,c),this.h()},h(){we(e.src,n=Ht+"/assets/shironeko-confused.png")||g(e,"src",n),g(e,"alt","Nothing here..."),g(e,"class","svelte-1bb5e7g")},m(c,u){j(c,e,u),j(c,t,u),j(c,s,u),j(c,o,u),L(i,c,u),a=!0},p(c,[u]){const p={};u&4&&(p.$$scope={dirty:u,ctx:c}),i.$set(p)},i(c){a||(v(i.$$.fragment,c),a=!0)},o(c){C(i.$$.fragment,c),a=!1},d(c){c&&(m(e),m(t),m(s),m(o)),M(i,c)}}}function _l(l){const e=Ve();return[e,()=>{He.reset(),Be.reset(),e("sortfilterupdate")}]}class gl extends ce{constructor(e){super(),ue(this,e,_l,pl,ae,{})}}function dl(l){const e=l-1;return e*e*e+1}function ml(l,{delay:e=0,duration:n=400,easing:t=dl,x:s=0,y:r=0,opacity:o=0}={}){const i=getComputedStyle(l),a=+i.opacity,c=i.transform==="none"?"":i.transform,u=a*(1-o),[p,f]=ft(s),[k,_]=ft(r);return{delay:e,duration:n,easing:t,css:(b,B)=>`
			transform: ${c} translate(${(1-b)*p}${f}, ${(1-b)*k}${_});
			opacity: ${a-u*B}`}}function hl(l){let e;return{c(){e=re("Ok")},l(n){e=oe(n,"Ok")},m(n,t){j(n,e,t)},d(n){n&&m(e)}}}function $l(l){let e,n,t,s="This website uses cookies.",r,o,i,a;return o=new qe({props:{title:"Accept cookies",$$slots:{default:[hl]},$$scope:{ctx:l}}}),o.$on("click",l[0]),{c(){e=E("section"),n=E("div"),t=E("span"),t.textContent=s,r=N(),R(o.$$.fragment),this.h()},l(c){e=S(c,"SECTION",{class:!0});var u=A(e);n=S(u,"DIV",{class:!0});var p=A(n);t=S(p,"SPAN",{"data-svelte-h":!0}),ie(t)!=="svelte-2018sg"&&(t.textContent=s),r=O(p),F(o.$$.fragment,p),p.forEach(m),u.forEach(m),this.h()},h(){g(n,"class","svelte-76nt2a"),g(e,"class","svelte-76nt2a")},m(c,u){j(c,e,u),d(e,n),d(n,t),d(n,r),L(o,n,null),a=!0},p(c,[u]){const p={};u&2&&(p.$$scope={dirty:u,ctx:c}),o.$set(p)},i(c){a||(v(o.$$.fragment,c),i&&i.end(1),a=!0)},o(c){C(o.$$.fragment,c),c&&(i=_n(e,ml,{y:200,duration:200})),a=!1},d(c){c&&m(e),M(o),c&&i&&i.end()}}}function vl(l){return[()=>en.set(!0)]}class bl extends ce{constructor(e){super(),ue(this,e,vl,$l,ae,{})}}const{document:ct}=gn;function kl(l){let e;return{c(){e=re("Search")},l(n){e=oe(n,"Search")},m(n,t){j(n,e,t)},i:te,o:te,d(n){n&&m(e)}}}function wl(l){let e,n;return e=new xt({}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function yl(l){let e,n,t,s;const r=[wl,kl],o=[];function i(a,c){return a[0]?0:1}return e=i(l),n=o[e]=r[e](l),{c(){n.c(),t=je()},l(a){n.l(a),t=je()},m(a,c){o[e].m(a,c),j(a,t,c),s=!0},p(a,c){let u=e;e=i(a),e!==u&&(pe(),C(o[u],1,1,()=>{o[u]=null}),_e(),n=o[e],n||(n=o[e]=r[e](a),n.c()),v(n,1),n.m(t.parentNode,t))},i(a){s||(v(n),s=!0)},o(a){C(n),s=!1},d(a){a&&m(t),o[e].d(a)}}}function Cl(l){let e,n,t,s,r,o;const i=[Il,Sl],a=[];function c(u,p){return u[3].postCount===0?0:1}return n=c(l),t=a[n]=i[n](l),r=new Fn({}),{c(){e=E("section"),t.c(),s=N(),R(r.$$.fragment),this.h()},l(u){e=S(u,"SECTION",{class:!0});var p=A(e);t.l(p),p.forEach(m),s=O(u),F(r.$$.fragment,u),this.h()},h(){g(e,"class","svelte-v6wq8y")},m(u,p){j(u,e,p),a[n].m(e,null),j(u,s,p),L(r,u,p),o=!0},p(u,p){let f=n;n=c(u),n===f?a[n].p(u,p):(pe(),C(a[f],1,1,()=>{a[f]=null}),_e(),t=a[n],t?t.p(u,p):(t=a[n]=i[n](u),t.c()),v(t,1),t.m(e,null))},i(u){o||(v(t),v(r.$$.fragment,u),o=!0)},o(u){C(t),C(r.$$.fragment,u),o=!1},d(u){u&&(m(e),m(s)),a[n].d(),M(r,u)}}}function El(l){let e,n;return e=new Qn({props:{error:l[1]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.error=t[1]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Sl(l){let e,n,t,s,r,o;e=new ul({}),e.$on("sortfilterupdate",l[10]),e.$on("endreached",l[11]);const i=[Tl,Dl],a=[];function c(u,p){return u[3].posts.length===u[3].postCount?0:1}return t=c(l),s=a[t]=i[t](l),{c(){R(e.$$.fragment),n=N(),s.c(),r=je()},l(u){F(e.$$.fragment,u),n=O(u),s.l(u),r=je()},m(u,p){L(e,u,p),j(u,n,p),a[t].m(u,p),j(u,r,p),o=!0},p(u,p){let f=t;t=c(u),t===f?a[t].p(u,p):(pe(),C(a[f],1,1,()=>{a[f]=null}),_e(),s=a[t],s?s.p(u,p):(s=a[t]=i[t](u),s.c()),v(s,1),s.m(r.parentNode,r))},i(u){o||(v(e.$$.fragment,u),v(s),o=!0)},o(u){C(e.$$.fragment,u),C(s),o=!1},d(u){u&&(m(n),m(r)),M(e,u),a[t].d(u)}}}function Il(l){let e,n;return e=new gl({}),e.$on("sortfilterupdate",l[10]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},p:te,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Dl(l){let e,n,t,s;return e=new tn({props:{absoluteTop:void 0,rootMargin:1e3/Number(l[7])+"px"}}),e.$on("intersection",l[11]),t=new qe({props:{title:"Load more posts",$$slots:{default:[Ol]},$$scope:{ctx:l}}}),t.$on("click",l[11]),{c(){R(e.$$.fragment),n=N(),R(t.$$.fragment)},l(r){F(e.$$.fragment,r),n=O(r),F(t.$$.fragment,r)},m(r,o){L(e,r,o),j(r,n,o),L(t,r,o),s=!0},p(r,o){const i={};o&128&&(i.rootMargin=1e3/Number(r[7])+"px"),e.$set(i);const a={};o&33554433&&(a.$$scope={dirty:o,ctx:r}),t.$set(a)},i(r){s||(v(e.$$.fragment,r),v(t.$$.fragment,r),s=!0)},o(r){C(e.$$.fragment,r),C(t.$$.fragment,r),s=!1},d(r){r&&m(n),M(e,r),M(t,r)}}}function Tl(l){let e,n;return e=new Zn({}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},p:te,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Pl(l){let e;return{c(){e=re("Load more")},l(n){e=oe(n,"Load more")},m(n,t){j(n,e,t)},i:te,o:te,d(n){n&&m(e)}}}function Nl(l){let e,n;return e=new xt({}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Ol(l){let e,n,t,s;const r=[Nl,Pl],o=[];function i(a,c){return a[0]?0:1}return e=i(l),n=o[e]=r[e](l),{c(){n.c(),t=je()},l(a){n.l(a),t=je()},m(a,c){o[e].m(a,c),j(a,t,c),s=!0},p(a,c){let u=e;e=i(a),e!==u&&(pe(),C(o[u],1,1,()=>{o[u]=null}),_e(),n=o[e],n||(n=o[e]=r[e](a),n.c()),v(n,1),n.m(t.parentNode,t))},i(a){s||(v(n),s=!0)},o(a){C(n),s=!1},d(a){a&&m(t),o[e].d(a)}}}function Lt(l){let e,n;return e=new bl({}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){L(e,t,s),n=!0},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function jl(l){let e,n,t,s,r,o,i,a,c,u,p,f,k,_,b,B,h,$,w;s=new mn({}),o=new Rn({props:{placeholder:"Search for tags",fetchSuggestions:l[9]}}),o.$on("pick",l[12]),a=new qe({props:{id:"btn-search",title:"Search with the tags above",$$slots:{default:[yl]},$$scope:{ctx:l}}}),a.$on("click",l[10]),u=new hn({props:{tags:[...l[5],...l[4]]}}),u.$on("click",l[13]),u.$on("contextmenu",l[14]),u.$on("createSupertag",l[15]);const y=[El,Cl],z=[];function J(P,U){return P[1]?0:P[3].requested?1:-1}~(f=J(l))&&(k=z[f]=y[f](l));function V(P){l[16](P)}let I={tags:l[5]};l[2]!==void 0&&(I.dialog=l[2]),b=new Kn({props:I}),ke.push(()=>Le(b,"dialog",V)),b.$on("submit",l[17]);let T=!l[8]&&Lt();return{c(){e=E("meta"),n=N(),t=E("section"),R(s.$$.fragment),r=N(),R(o.$$.fragment),i=N(),R(a.$$.fragment),c=N(),R(u.$$.fragment),p=N(),k&&k.c(),_=N(),R(b.$$.fragment),h=N(),T&&T.c(),$=je(),this.h()},l(P){const U=pn("svelte-7jdp3v",ct.head);e=S(U,"META",{name:!0,content:!0}),U.forEach(m),n=O(P),t=S(P,"SECTION",{id:!0,class:!0});var D=A(t);F(s.$$.fragment,D),r=O(D),F(o.$$.fragment,D),i=O(D),F(a.$$.fragment,D),c=O(D),F(u.$$.fragment,D),D.forEach(m),p=O(P),k&&k.l(P),_=O(P),F(b.$$.fragment,P),h=O(P),T&&T.l(P),$=je(),this.h()},h(){ct.title="kurosearch - Rule34 Hentai",g(e,"name","description"),g(e,"content","Simple and powerful Rule34 browsing site with a focus on simplicity and user experience."),g(t,"id","search"),g(t,"class","svelte-v6wq8y")},m(P,U){d(ct.head,e),j(P,n,U),j(P,t,U),L(s,t,null),d(t,r),L(o,t,null),d(t,i),L(a,t,null),d(t,c),L(u,t,null),j(P,p,U),~f&&z[f].m(P,U),j(P,_,U),L(b,P,U),j(P,h,U),T&&T.m(P,U),j(P,$,U),w=!0},p(P,[U]){const D={};U&33554433&&(D.$$scope={dirty:U,ctx:P}),a.$set(D);const Z={};U&48&&(Z.tags=[...P[5],...P[4]]),u.$set(Z);let Q=f;f=J(P),f===Q?~f&&z[f].p(P,U):(k&&(pe(),C(z[Q],1,1,()=>{z[Q]=null}),_e()),~f?(k=z[f],k?k.p(P,U):(k=z[f]=y[f](P),k.c()),v(k,1),k.m(_.parentNode,_)):k=null);const H={};U&32&&(H.tags=P[5]),!B&&U&4&&(B=!0,H.dialog=P[2],Fe(()=>B=!1)),b.$set(H),P[8]?T&&(pe(),C(T,1,1,()=>{T=null}),_e()):T?U&256&&v(T,1):(T=Lt(),T.c(),v(T,1),T.m($.parentNode,$))},i(P){w||(v(s.$$.fragment,P),v(o.$$.fragment,P),v(a.$$.fragment,P),v(u.$$.fragment,P),v(k),v(b.$$.fragment,P),v(T),w=!0)},o(P){C(s.$$.fragment,P),C(o.$$.fragment,P),C(a.$$.fragment,P),C(u.$$.fragment,P),C(k),C(b.$$.fragment,P),C(T),w=!1},d(P){P&&(m(n),m(t),m(p),m(_),m(h),m($)),m(e),M(s),M(o),M(a),M(u),~f&&z[f].d(P),M(b,P),T&&T.d(P)}}}function Al(l,e,n){let t,s,r,o,i,a,c,u,p;fe(l,Ye,D=>n(3,t=D)),fe(l,at,D=>n(4,s=D)),fe(l,Be,D=>n(19,r=D)),fe(l,He,D=>n(20,o=D)),fe(l,zn,D=>n(21,i=D)),fe(l,ot,D=>n(5,a=D)),fe(l,_t,D=>n(6,c=D)),fe(l,Ut,D=>n(7,u=D)),fe(l,en,D=>n(8,p=D)),console.log(`%ckurosearch
%cHi, if you are reading this because you are debugging or reverse-engineering, feel free to send me a DM on Discord :)`,"color:crimson;font-size:32px;","color:unset;font-size:auto;");let f=!1,k,_,b=0;const B=async D=>{const Z=await Ln(D);return[...c.items.filter(({name:H})=>H.toLowerCase().includes(D.toLowerCase())).map(H=>({label:H.name,count:H.tags.length,type:"supertag"})),...Z]},h=()=>new On().withPid(t.pageCount).withTags(a).withBlockedContent(i).withSortProperty(o.property).withSortDirection(o.direction).withScoreValue(r.scoreValue).withScoreComparator(r.scoreComparator).withRating(r.rating).withSupertags(s),$=async D=>{if(!f){n(1,k=void 0),n(0,f=!0);try{const Z=t.pageCount;await D(),Vn(Z).catch(()=>{})}catch(Z){n(1,k=Z),console.warn(Z)}finally{n(0,f=!1)}}},w=async()=>{Ye.reset(),b=0,$(async()=>{const[D,Z]=await h().getPageAndCount();Ye.addPage(D,Z)})},y=async()=>{$(async()=>{const D=await h().getPage();Ye.addPage(D)})},z=D=>{var Z,Q;if((D.key==="/"||D.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((Z=document.getElementById("searchbar"))==null||Z.focus(),D.preventDefault(),D.stopPropagation()),D.ctrlKey&&D.key==="Enter"&&(D.preventDefault(),D.stopPropagation(),w()),D.ctrlKey&&D.key==="m"&&((Q=document.getElementById("select-modifier"))==null||Q.click()),D.ctrlKey&&D.key==="ArrowDown"){const H=document.getElementsByClassName("post-media");H[b].focus(),b=Math.min(b+1,Math.max(0,H.length-1))}D.ctrlKey&&D.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[b].focus(),b=Math.max(b-1,0))};lt(async()=>{document.addEventListener("keydown",z),t.postCount===0&&w()}),rt(()=>{document.removeEventListener("keydown",z)});const J=async D=>{const Z=D.detail;if(Z.type==="supertag"){const Q=c.items.find(H=>H.name===Z.label);if(!Q){console.warn("Supertag not present.");return}at.addOrReplace(Q)}else{const Q=await Mn(D.detail.label);ot.addOrReplace({name:D.detail.label,modifier:D.detail.modifier,count:D.detail.count,type:(Q==null?void 0:Q.type)??"tag"})}},V=D=>"description"in D.detail?at.removeByName(D.detail.name):ot.removeByName(D.detail.name),I=D=>{"description"in D.detail||(D.detail.modifier=Bn(D.detail.modifier),ot.addOrReplace(D.detail))},T=()=>{_.showModal(),Gt("dialog")};function P(D){_=D,n(2,_)}return[f,k,_,t,s,a,c,u,p,B,w,y,J,V,I,T,P,D=>_t.add(D.detail)]}class ar extends ce{constructor(e){super(),ue(this,e,Al,jl,ae,{})}}export{ar as component};
