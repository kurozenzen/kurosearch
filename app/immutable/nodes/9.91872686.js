import{s as oe,f as R,a as B,W as ne,l as I,z as le,g as D,d as S,c as K,h as Q,X as ie,m as L,j as z,u as i,i as ee,n as M,H as ce,A as q}from"../chunks/scheduler.51196a30.js";import{S as me,i as ue,b as $,d as F,m as G,a as J,t as Y,e as Z}from"../chunks/index.456a70cf.js";import{e as ae}from"../chunks/each.e59479a4.js";import{K as pe,A as ge}from"../chunks/ActiveTagList.23fa9778.js";import{S as he}from"../chunks/Searchbar.c3373a7c.js";import{g as de,b as fe,u as _e,a as we}from"../chunks/user-id-store.66fd1ad4.js";import{a as x,r as ye}from"../chunks/blocking-group-data.5e4f115e.js";import{a as W}from"../chunks/active-tags-store.c9bbda04.js";import{S as Se,f as ve,s as be}from"../chunks/url-parsing.55bc59a5.js";import{b as ke}from"../chunks/blocked-content-store.0bef0832.js";import{n as Ce,s as Te}from"../chunks/supertags-store.0aed9372.js";function se(t,n,r){const s=t.slice();return s[18]=n[r],s}function re(t){let n,r=t[18][0]+"",s,d,_=t[18][1]+"",m;return{c(){n=R("p"),s=I(r),d=I("="),m=I(_),this.h()},l(u){n=D(u,"P",{class:!0});var o=Q(n);s=L(o,r),d=L(o,"="),m=L(o,_),o.forEach(S),this.h()},h(){z(n,"class","fixed svelte-15wziqd")},m(u,o){ee(u,n,o),i(n,s),i(n,d),i(n,m)},p(u,o){o&64&&r!==(r=u[18][0]+"")&&M(s,r),o&64&&_!==(_=u[18][1]+"")&&M(m,_)},d(u){u&&S(n)}}}function Ee(t){let n,r,s,d,_,m,u,o,P,v,C,O,p,y,T,j,U,b,A=t[5][0]+"",H,e,k=t[5][1]+"",w,g;d=new pe({}),m=new he({props:{placeholder:"Search for tags",fetchSuggestions:t[9]}}),m.$on("pick",t[14]),o=new ge({props:{tags:[...t[2],...t[1]]}}),o.$on("click",t[15]),o.$on("contextmenu",t[16]);let N=ae(t[6]),c=[];for(let a=0;a<N.length;a+=1)c[a]=re(se(t,N,a));return{c(){n=R("meta"),r=B(),s=R("section"),$(d.$$.fragment),_=B(),$(m.$$.fragment),u=B(),$(o.$$.fragment),P=B(),v=R("code"),C=new ne(!1),O=B(),p=R("code"),y=R("p"),T=I(t[7]),j=B();for(let a=0;a<c.length;a+=1)c[a].c();U=B(),b=R("p"),H=I(A),e=I("="),w=I(k),this.h()},l(a){const f=le("svelte-2w1wl5",document.head);n=D(f,"META",{name:!0,content:!0}),f.forEach(S),r=K(a),s=D(a,"SECTION",{class:!0});var l=Q(s);F(d.$$.fragment,l),_=K(l),F(m.$$.fragment,l),u=K(l),F(o.$$.fragment,l),P=K(l),v=D(l,"CODE",{class:!0});var h=Q(v);C=ie(h,!1),h.forEach(S),O=K(l),p=D(l,"CODE",{class:!0});var E=Q(p);y=D(E,"P",{class:!0});var te=Q(y);T=L(te,t[7]),te.forEach(S),j=K(E);for(let X=0;X<c.length;X+=1)c[X].l(E);U=K(E),b=D(E,"P",{class:!0});var V=Q(b);H=L(V,A),e=L(V,"="),w=L(V,k),V.forEach(S),E.forEach(S),l.forEach(S),this.h()},h(){document.title="kurosearch - Query Builder",z(n,"name","description"),z(n,"content","Test your kurosearch queries. Useful if you already know how to use rule34.xxx"),C.a=null,z(v,"class","svelte-15wziqd"),z(y,"class","base svelte-15wziqd"),z(b,"class","tags svelte-15wziqd"),z(p,"class","svelte-15wziqd"),z(s,"class","svelte-15wziqd")},m(a,f){i(document.head,n),ee(a,r,f),ee(a,s,f),G(d,s,null),i(s,_),G(m,s,null),i(s,u),G(o,s,null),i(s,P),i(s,v),C.m(t[0],v),i(s,O),i(s,p),i(p,y),i(y,T),i(p,j);for(let l=0;l<c.length;l+=1)c[l]&&c[l].m(p,null);i(p,U),i(p,b),i(b,H),i(b,e),i(b,w),g=!0},p(a,[f]){const l={};if(f&6&&(l.tags=[...a[2],...a[1]]),o.$set(l),(!g||f&1)&&C.p(a[0]),(!g||f&128)&&M(T,a[7]),f&64){N=ae(a[6]);let h;for(h=0;h<N.length;h+=1){const E=se(a,N,h);c[h]?c[h].p(E,f):(c[h]=re(E),c[h].c(),c[h].m(p,U))}for(;h<c.length;h+=1)c[h].d(1);c.length=N.length}(!g||f&32)&&A!==(A=a[5][0]+"")&&M(H,A),(!g||f&32)&&k!==(k=a[5][1]+"")&&M(w,k)},i(a){g||(J(d.$$.fragment,a),J(m.$$.fragment,a),J(o.$$.fragment,a),g=!0)},o(a){Y(d.$$.fragment,a),Y(m.$$.fragment,a),Y(o.$$.fragment,a),g=!1},d(a){a&&(S(r),S(s)),S(n),Z(d),Z(m),Z(o),ce(c,a)}}}function qe(t,n,r){let s,d,_,m,u,o,P,v,C,O,p,y,T;q(t,x,e=>r(1,u=e)),q(t,ve,e=>r(10,o=e)),q(t,be,e=>r(11,P=e)),q(t,ke,e=>r(12,v=e)),q(t,W,e=>r(2,C=e)),q(t,ye,e=>r(13,O=e)),q(t,_e,e=>r(3,p=e)),q(t,we,e=>r(4,y=e)),q(t,Te,e=>r(8,T=e));const j=async e=>{const k=await de(e);return[...T.items.filter(({name:g})=>g.toLowerCase().includes(e.toLowerCase())).map(g=>({label:g.name,count:g.tags.length,type:"supertag"})),...k]},U=e=>{try{return new URL(e)}catch{return null}},b=async e=>{const k=e.detail;if(k.type==="supertag"){const w=T.items.find(g=>g.name===k.label);if(!w){console.warn("Supertag not present.");return}x.addOrReplace(w)}else{const w=await fe(e.detail.label,y,p);W.addOrReplace({name:e.detail.label,modifier:e.detail.modifier,count:e.detail.count,type:(w==null?void 0:w.type)??"tag"})}},A=e=>"description"in e.detail?x.removeByName(e.detail.name):W.removeByName(e.detail.name),H=e=>{"description"in e.detail||(e.detail.modifier=Ce(e.detail.modifier),W.addOrReplace(e.detail))};return t.$$.update=()=>{t.$$.dirty&15390&&r(0,s=U(new Se().withApiKey(y).withUserId(p).withPid(O.pageCount).withTags(C).withBlockedContent(v).withSortProperty(P.property).withSortDirection(P.direction).withScoreValue(o.scoreValue).withScoreComparator(o.scoreComparator).withRating(o.rating).withSupertags(u).getQuery())),t.$$.dirty&1&&r(7,d=s&&`${s.protocol}//${s.hostname}`),t.$$.dirty&1&&r(6,_=s?[...s.searchParams.entries()].filter(([e])=>["page","s","q","fields","json","limit"].includes(e)):[]),t.$$.dirty&1&&r(5,m=s?[...s.searchParams.entries()].find(([e])=>e==="tags")??["tags",""]:["tags",""])},[s,u,C,p,y,m,_,d,T,j,o,P,v,O,b,A,H]}class He extends me{constructor(n){super(),ue(this,n,qe,Ee,oe,{})}}export{He as component};
